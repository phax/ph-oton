/*
   Copyright 2009-2017 SpryMedia Ltd.

 This source file is free software, available under the following license:
   MIT license - http://datatables.net/license/mit

 This source file is distributed in the hope that it will be useful, but
 WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
 or FITNESS FOR A PARTICULAR PURPOSE. See the license files for details.

 For details please refer to: http://www.datatables.net
*/
(function(e){"function"===typeof define&&define.amd?define(["jquery","datatables.net"],function(g){return e(g,window,document)}):"object"===typeof exports?module.exports=function(g,h){g||(g=window);h&&h.fn.dataTable||(h=require("datatables.net")(g,h).$);return e(h,g,g.document)}:e(jQuery,window,document)})(function(e,g,h,m){var l=e.fn.dataTable,n=0,k=function(a,b){if(!(this instanceof k))throw"FixedHeader must be initialised with the 'new' keyword.";!0===b&&(b={});a=new l.Api(a);this.c=e.extend(!0,
{},k.defaults,b);this.s={dt:a,position:{theadTop:0,tbodyTop:0,tfootTop:0,tfootBottom:0,width:0,left:0,tfootHeight:0,theadHeight:0,windowHeight:e(g).height(),visible:!0},headerMode:null,footerMode:null,autoWidth:a.settings()[0].oFeatures.bAutoWidth,namespace:".dtfc"+n++,scrollLeft:{header:-1,footer:-1},enable:!0};this.dom={floatingHeader:null,thead:e(a.table().header()),tbody:e(a.table().body()),tfoot:e(a.table().footer()),header:{host:null,floating:null,placeholder:null},footer:{host:null,floating:null,
placeholder:null}};this.dom.header.host=this.dom.thead.parent();this.dom.footer.host=this.dom.tfoot.parent();var d=a.settings()[0];if(d._fixedHeader)throw"FixedHeader already initialised on table "+d.nTable.id;d._fixedHeader=this;this._constructor()};e.extend(k.prototype,{enable:function(a){this.s.enable=a;this.c.header&&this._modeChange("in-place","header",!0);this.c.footer&&this.dom.tfoot.length&&this._modeChange("in-place","footer",!0);this.update()},headerOffset:function(a){a!==m&&(this.c.headerOffset=
a,this.update());return this.c.headerOffset},footerOffset:function(a){a!==m&&(this.c.footerOffset=a,this.update());return this.c.footerOffset},update:function(){this._positions();this._scroll(!0)},_constructor:function(){var a=this,b=this.s.dt;e(g).on("scroll"+this.s.namespace,function(){a._scroll()}).on("resize"+this.s.namespace,function(){a.s.position.windowHeight=e(g).height();a.update()});var d=e(".fh-fixedHeader");!this.c.headerOffset&&d.length&&(this.c.headerOffset=d.outerHeight());d=e(".fh-fixedFooter");
!this.c.footerOffset&&d.length&&(this.c.footerOffset=d.outerHeight());b.on("column-reorder.dt.dtfc column-visibility.dt.dtfc draw.dt.dtfc column-sizing.dt.dtfc",function(){a.update()});b.on("destroy.dtfc",function(){b.off(".dtfc");e(g).off(a.s.namespace)});this._positions();this._scroll()},_clone:function(a,b){var d=this.s.dt,c=this.dom[a],f="header"===a?this.dom.thead:this.dom.tfoot;!b&&c.floating?c.floating.removeClass("fixedHeader-floating fixedHeader-locked"):(c.floating&&(c.placeholder.remove(),
this._unsize(a),c.floating.children().detach(),c.floating.remove()),c.floating=e(d.table().node().cloneNode(!1)).css("table-layout","fixed").removeAttr("id").append(f).appendTo("body"),c.placeholder=f.clone(!1),c.placeholder.find("*[id]").removeAttr("id"),c.host.prepend(c.placeholder),this._matchWidths(c.placeholder,c.floating))},_matchWidths:function(a,b){var d=function(b){return e(b,a).map(function(){return e(this).width()}).toArray()},c=function(a,c){e(a,b).each(function(a){e(this).css({width:c[a],
minWidth:c[a]})})},f=d("th"),d=d("td");c("th",f);c("td",d)},_unsize:function(a){var b=this.dom[a].floating;b&&("footer"===a||"header"===a&&!this.s.autoWidth)?e("th, td",b).css({width:"",minWidth:""}):b&&"header"===a&&e("th, td",b).css("min-width","")},_horizontal:function(a,b){var d=this.dom[a],c=this.s.position,e=this.s.scrollLeft;d.floating&&e[a]!==b&&(d.floating.css("left",c.left-b),e[a]=b)},_modeChange:function(a,b,d){var c=this.dom[b],f=this.s.position,g=e.contains(this.dom["footer"===b?"tfoot":
"thead"][0],h.activeElement)?h.activeElement:null;"in-place"===a?(c.placeholder&&(c.placeholder.remove(),c.placeholder=null),this._unsize(b),"header"===b?c.host.prepend(this.dom.thead):c.host.append(this.dom.tfoot),c.floating&&(c.floating.remove(),c.floating=null)):"in"===a?(this._clone(b,d),c.floating.addClass("fixedHeader-floating").css("header"===b?"top":"bottom",this.c[b+"Offset"]).css("left",f.left+"px").css("width",f.width+"px"),"footer"===b&&c.floating.css("top","")):"below"===a?(this._clone(b,
d),c.floating.addClass("fixedHeader-locked").css("top",f.tfootTop-f.theadHeight).css("left",f.left+"px").css("width",f.width+"px")):"above"===a&&(this._clone(b,d),c.floating.addClass("fixedHeader-locked").css("top",f.tbodyTop).css("left",f.left+"px").css("width",f.width+"px"));g&&g!==h.activeElement&&g.focus();this.s.scrollLeft.header=-1;this.s.scrollLeft.footer=-1;this.s[b+"Mode"]=a},_positions:function(){var a=this.s.dt.table(),b=this.s.position,d=this.dom,a=e(a.node()),c=a.children("thead"),f=
a.children("tfoot"),d=d.tbody;b.visible=a.is(":visible");b.width=a.outerWidth();b.left=a.offset().left;b.theadTop=c.offset().top;b.tbodyTop=d.offset().top;b.theadHeight=b.tbodyTop-b.theadTop;f.length?(b.tfootTop=f.offset().top,b.tfootBottom=b.tfootTop+f.outerHeight(),b.tfootHeight=b.tfootBottom-b.tfootTop):(b.tfootTop=b.tbodyTop+d.outerHeight(),b.tfootBottom=b.tfootTop,b.tfootHeight=b.tfootTop)},_scroll:function(a){var b=e(h).scrollTop(),d=e(h).scrollLeft(),c=this.s.position,f;this.s.enable&&(this.c.header&&
(f=!c.visible||b<=c.theadTop-this.c.headerOffset?"in-place":b<=c.tfootTop-c.theadHeight-this.c.headerOffset?"in":"below",(a||f!==this.s.headerMode)&&this._modeChange(f,"header",a),this._horizontal("header",d)),this.c.footer&&this.dom.tfoot.length&&(b=!c.visible||b+c.windowHeight>=c.tfootBottom+this.c.footerOffset?"in-place":c.windowHeight+b>c.tbodyTop+c.tfootHeight+this.c.footerOffset?"in":"above",(a||b!==this.s.footerMode)&&this._modeChange(b,"footer",a),this._horizontal("footer",d)))}});k.version=
"3.1.3";k.defaults={header:!0,footer:!1,headerOffset:0,footerOffset:0};e.fn.dataTable.FixedHeader=k;e.fn.DataTable.FixedHeader=k;e(h).on("init.dt.dtfh",function(a,b,d){"dt"===a.namespace&&(a=b.oInit.fixedHeader,d=l.defaults.fixedHeader,!a&&!d||b._fixedHeader||(d=e.extend({},d,a),!1!==a&&new k(b,d)))});l.Api.register("fixedHeader()",function(){});l.Api.register("fixedHeader.adjust()",function(){return this.iterator("table",function(a){(a=a._fixedHeader)&&a.update()})});l.Api.register("fixedHeader.enable()",
function(a){return this.iterator("table",function(b){b=b._fixedHeader;a=a!==m?a:!0;b&&a!==b.s.enable&&b.enable(a)})});l.Api.register("fixedHeader.disable()",function(){return this.iterator("table",function(a){(a=a._fixedHeader)&&a.s.enable&&a.enable(!1)})});e.each(["header","footer"],function(a,b){l.Api.register("fixedHeader."+b+"Offset()",function(a){var c=this.context;return a===m?c.length&&c[0]._fixedHeader?c[0]._fixedHeader[b+"Offset"]():m:this.iterator("table",function(c){if(c=c._fixedHeader)c[b+
"Offset"](a)})})});return k});
