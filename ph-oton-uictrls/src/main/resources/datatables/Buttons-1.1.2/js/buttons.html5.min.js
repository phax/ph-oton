(function(g){"function"===typeof define&&define.amd?define(["jquery","datatables.net","datatables.net-buttons"],function(f){return g(f,window,document)}):"object"===typeof exports?module.exports=function(f,e){f||(f=window);e&&e.fn.dataTable||(e=require("datatables.net")(f,e).$);e.fn.dataTable.Buttons||require("datatables.net-buttons")(f,e);return g(e,f,f.document)}:g(jQuery,window,document)})(function(g,f,e,p){var h=g.fn.dataTable,x=function(a){if("undefined"===typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var b=
a.document,d=b.createElementNS("http://www.w3.org/1999/xhtml","a"),c="download"in d,q=function(c){var d=b.createEvent("MouseEvents");d.initMouseEvent("click",!0,!1,a,0,0,0,0,0,!1,!1,!1,!1,0,null);c.dispatchEvent(d)},m=a.webkitRequestFileSystem,f=a.requestFileSystem||m||a.mozRequestFileSystem,n=function(b){(a.setImmediate||a.setTimeout)(function(){throw b;},0)},g=0,z=function(b){var c=function(){"string"===typeof b?(a.URL||a.webkitURL||a).revokeObjectURL(b):b.remove()};a.chrome?c():setTimeout(c,500)},
e=function(a,b,c){b=[].concat(b);for(var d=b.length;d--;){var m=a["on"+b[d]];if("function"===typeof m)try{m.call(a,c||a)}catch(q){n(q)}}},B=function(a){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["﻿",a],{type:a.type}):a},t=function(b,n){b=B(b);var k=this,l=b.type,t=!1,r,h,u=function(){e(k,["writestart","progress","write","writeend"])},v=function(){if(t||!r)r=(a.URL||a.webkitURL||a).createObjectURL(b);h?h.location.href=r:a.open(r,"_blank")===
p&&"undefined"!==typeof safari&&(a.location.href=r);k.readyState=k.DONE;u();z(r)},w=function(a){return function(){if(k.readyState!==k.DONE)return a.apply(this,arguments)}},x={create:!0,exclusive:!1},y;k.readyState=k.INIT;n||(n="download");if(c)r=(a.URL||a.webkitURL||a).createObjectURL(b),d.href=r,d.download=n,q(d),k.readyState=k.DONE,u(),z(r);else{a.chrome&&l&&"application/octet-stream"!==l&&(y=b.slice||b.webkitSlice,b=y.call(b,0,b.size,"application/octet-stream"),t=!0);m&&"download"!==n&&(n+=".download");
if("application/octet-stream"===l||m)h=a;f?(g+=b.size,f(a.TEMPORARY,g,w(function(a){a.root.getDirectory("saved",x,w(function(a){var c=function(){a.getFile(n,x,w(function(a){a.createWriter(w(function(c){c.onwriteend=function(b){h.location.href=a.toURL();k.readyState=k.DONE;e(k,"writeend",b);z(a)};c.onerror=function(){var a=c.error;a.code!==a.ABORT_ERR&&v()};["writestart","progress","write","abort"].forEach(function(a){c["on"+a]=k["on"+a]});c.write(b);k.abort=function(){c.abort();k.readyState=k.DONE};
k.readyState=k.WRITING}),v)}),v)};a.getFile(n,{create:!1},w(function(a){a.remove();c()}),w(function(a){a.code===a.NOT_FOUND_ERR?c():v()}))}),v)}),v)):v()}},l=t.prototype;if("undefined"!==typeof navigator&&navigator.msSaveOrOpenBlob)return function(a,b){return navigator.msSaveOrOpenBlob(B(a),b)};l.abort=function(){this.readyState=this.DONE;e(this,"abort")};l.readyState=l.INIT=0;l.WRITING=1;l.DONE=2;l.error=l.onwritestart=l.onprogress=l.onwrite=l.onabort=l.onerror=l.onwriteend=null;return function(a,
b){return new t(a,b)}}}(f),y=function(a,b){var d="*"===a.filename&&"*"!==a.title&&a.title!==p?a.title:a.filename;"function"===typeof d&&(d=d());-1!==d.indexOf("*")&&(d=d.replace("*",g("title").text()));d=d.replace(/[^a-zA-Z0-9_\u00A1-\uFFFF\.,\-_ !\(\)]/g,"");return b===p||!0===b?d+a.extension:d},E=function(a){var b="Sheet1";a.sheetName&&(b=a.sheetName.replace(/[\[\]\*\/\\\?\:]/g,""));return b},F=function(a){a=a.title;"function"===typeof a&&(a=a());return-1!==a.indexOf("*")?a.replace("*",g("title").text()):
a},A=function(a){return a.newline?a.newline:navigator.userAgent.match(/Windows/)?"\r\n":"\n"},C=function(a,b){for(var d=A(b),c=a.buttons.exportData(b.exportOptions),q=b.fieldBoundary,m=b.fieldSeparator,g=new RegExp(q,"g"),n=b.escapeChar!==p?b.escapeChar:"\\",f=function(a){for(var b="",c=0,d=a.length;c<d;c++)0<c&&(b+=m),b+=q?q+(""+a[c]).replace(g,n+q)+q:a[c];return b},z=b.header?f(c.header)+d:"",e=b.footer&&c.footer?d+f(c.footer):"",h=[],t=0,l=c.body.length;t<l;t++)h.push(f(c.body[t]));return{str:z+
h.join(d)+e,rows:h.length}},D=function(){return-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&-1===navigator.userAgent.indexOf("Opera")},u={"_rels/.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\t<Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/></Relationships>',"xl/_rels/workbook.xml.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\t<Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet1.xml"/></Relationships>',
"[Content_Types].xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">\t<Default Extension="xml" ContentType="application/xml"/>\t<Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/>\t<Default Extension="jpeg" ContentType="image/jpeg"/>\t<Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/>\t<Override PartName="/xl/worksheets/sheet1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/></Types>',
"xl/workbook.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">\t<fileVersion appName="xl" lastEdited="5" lowestEdited="5" rupBuild="24816"/>\t<workbookPr showInkAnnotation="0" autoCompressPictures="0"/>\t<bookViews>\t\t<workbookView xWindow="0" yWindow="0" windowWidth="25600" windowHeight="19020" tabRatio="500"/>\t</bookViews>\t<sheets>\t\t<sheet name="__SHEET_NAME__" sheetId="1" r:id="rId1"/>\t</sheets></workbook>',
"xl/worksheets/sheet1.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac">\t<sheetData>\t\t__DATA__\t</sheetData></worksheet>'};h.ext.buttons.copyHtml5={className:"buttons-copy buttons-html5",
text:function(a){return a.i18n("buttons.copy","Copy")},action:function(a,b,d,c){a=C(b,c);var f=a.str;d=g("<div/>").css({height:1,width:1,overflow:"hidden",position:"fixed",top:0,left:0});c.customize&&(f=c.customize(f,c));c=g("<textarea readonly/>").val(f).appendTo(d);if(e.queryCommandSupported("copy")){d.appendTo(b.table().container());c[0].focus();c[0].select();try{e.execCommand("copy");d.remove();b.buttons.info(b.i18n("buttons.copyTitle","Copy to clipboard"),b.i18n("buttons.copySuccess",{1:"Copied one row to clipboard",
_:"Copied %d rows to clipboard"},a.rows),2E3);return}catch(n){}}a=g("<span>"+b.i18n("buttons.copyKeys","Press <i>ctrl</i> or <i>⌘</i> + <i>C</i> to copy the table data<br>to your system clipboard.<br><br>To cancel, click this message or press escape.")+"</span>").append(d);b.buttons.info(b.i18n("buttons.copyTitle","Copy to clipboard"),a,0);c[0].focus();c[0].select();var m=g(a).closest(".dt-button-info"),h=function(){m.off("click.buttons-copy");g(e).off(".buttons-copy");b.buttons.info(!1)};m.on("click.buttons-copy",
h);g(e).on("keydown.buttons-copy",function(a){27===a.keyCode&&h()}).on("copy.buttons-copy cut.buttons-copy",function(){h()})},exportOptions:{},fieldSeparator:"\t",fieldBoundary:"",header:!0,footer:!1};h.ext.buttons.csvHtml5={className:"buttons-csv buttons-html5",available:function(){return f.FileReader!==p&&f.Blob},text:function(a){return a.i18n("buttons.csv","CSV")},action:function(a,b,d,c){A(c);a=C(b,c).str;b=c.charset;c.customize&&(a=c.customize(a,c));!1!==b?(b||(b=e.characterSet||e.charset),b&&
(b=";charset="+b)):b="";x(new Blob([a],{type:"text/csv"+b}),y(c))},filename:"*",extension:".csv",exportOptions:{},fieldSeparator:",",fieldBoundary:'"',escapeChar:'"',charset:null,header:!0,footer:!1};h.ext.buttons.excelHtml5={className:"buttons-excel buttons-html5",available:function(){return f.FileReader!==p&&f.JSZip!==p&&!D()},text:function(a){return a.i18n("buttons.excel","Excel")},action:function(a,b,d,c){a="";b=b.buttons.exportData(c.exportOptions);d=function(a){for(var b=[],c=0,d=a.length;c<
d;c++){if(null===a[c]||a[c]===p)a[c]="";b.push("number"===typeof a[c]||a[c].match&&g.trim(a[c]).match(/^-?\d+(\.\d+)?$/)&&"0"!==a[c].charAt(0)?'<c t="n"><v>'+a[c]+"</v></c>":'<c t="inlineStr"><is><t>'+(a[c].replace?a[c].replace(/&(?!amp;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/[\x00-\x09\x0B\x0C\x0E-\x1F\x7F-\x9F]/g,""):a[c])+"</t></is></c>")}return"<row>"+b.join("")+"</row>"};c.header&&(a+=d(b.header));for(var e=0,m=b.body.length;e<m;e++)a+=d(b.body[e]);c.footer&&(a+=d(b.footer));
b=new f.JSZip;d=b.folder("_rels");var e=b.folder("xl"),m=b.folder("xl/_rels"),h=b.folder("xl/worksheets");b.file("[Content_Types].xml",u["[Content_Types].xml"]);d.file(".rels",u["_rels/.rels"]);e.file("workbook.xml",u["xl/workbook.xml"].replace("__SHEET_NAME__",E(c)));m.file("workbook.xml.rels",u["xl/_rels/workbook.xml.rels"]);h.file("sheet1.xml",u["xl/worksheets/sheet1.xml"].replace("__DATA__",a));x(b.generate({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),
y(c))},filename:"*",extension:".xlsx",exportOptions:{},header:!0,footer:!1};h.ext.buttons.pdfHtml5={className:"buttons-pdf buttons-html5",available:function(){return f.FileReader!==p&&f.pdfMake},text:function(a){return a.i18n("buttons.pdf","PDF")},action:function(a,b,d,c){A(c);a=b.buttons.exportData(c.exportOptions);b=[];c.header&&b.push(g.map(a.header,function(a){return{text:"string"===typeof a?a:a+"",style:"tableHeader"}}));var e=0;for(d=a.body.length;e<d;e++)b.push(g.map(a.body[e],function(a){return{text:"string"===
typeof a?a:a+"",style:e%2?"tableBodyEven":"tableBodyOdd"}}));c.footer&&b.push(g.map(a.footer,function(a){return{text:"string"===typeof a?a:a+"",style:"tableFooter"}}));a={pageSize:c.pageSize,pageOrientation:c.orientation,content:[{table:{headerRows:1,body:b},layout:"noBorders"}],styles:{tableHeader:{bold:!0,fontSize:11,color:"white",fillColor:"#2d4154",alignment:"center"},tableBodyEven:{},tableBodyOdd:{fillColor:"#f3f3f3"},tableFooter:{bold:!0,fontSize:11,color:"white",fillColor:"#2d4154"},title:{alignment:"center",
fontSize:15},message:{}},defaultStyle:{fontSize:10}};c.message&&a.content.unshift({text:c.message,style:"message",margin:[0,0,0,12]});c.title&&a.content.unshift({text:F(c,!1),style:"title",margin:[0,0,0,12]});c.customize&&c.customize(a,c);a=f.pdfMake.createPdf(a);"open"!==c.download||D()?a.getBuffer(function(a){a=new Blob([a],{type:"application/pdf"});x(a,y(c))}):a.open()},title:"*",filename:"*",extension:".pdf",exportOptions:{},orientation:"portrait",pageSize:"A4",header:!0,footer:!1,message:null,
customize:null,download:"download"};return h.Buttons});
