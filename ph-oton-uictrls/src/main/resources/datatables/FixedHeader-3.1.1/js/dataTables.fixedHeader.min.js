/*
   Copyright 2009-2016 SpryMedia Ltd.

 This source file is free software, available under the following license:
   MIT license - http://datatables.net/license/mit

 This source file is distributed in the hope that it will be useful, but
 WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
 or FITNESS FOR A PARTICULAR PURPOSE. See the license files for details.

 For details please refer to: http://www.datatables.net
*/
(function(d){"function"===typeof define&&define.amd?define(["jquery","datatables.net"],function(f){return d(f,window,document)}):"object"===typeof exports?module.exports=function(f,h){f||(f=window);h&&h.fn.dataTable||(h=require("datatables.net")(f,h).$);return d(h,f,f.document)}:d(jQuery,window,document)})(function(d,f,h,m){var l=d.fn.dataTable,n=0,k=function(a,b){if(!(this instanceof k))throw"FixedHeader must be initialised with the 'new' keyword.";!0===b&&(b={});a=new l.Api(a);this.c=d.extend(!0,
{},k.defaults,b);this.s={dt:a,position:{theadTop:0,tbodyTop:0,tfootTop:0,tfootBottom:0,width:0,left:0,tfootHeight:0,theadHeight:0,windowHeight:d(f).height(),visible:!0},headerMode:null,footerMode:null,autoWidth:a.settings()[0].oFeatures.bAutoWidth,namespace:".dtfc"+n++,scrollLeft:{header:-1,footer:-1},enable:!0};this.dom={floatingHeader:null,thead:d(a.table().header()),tbody:d(a.table().body()),tfoot:d(a.table().footer()),header:{host:null,floating:null,placeholder:null},footer:{host:null,floating:null,
placeholder:null}};this.dom.header.host=this.dom.thead.parent();this.dom.footer.host=this.dom.tfoot.parent();var e=a.settings()[0];if(e._fixedHeader)throw"FixedHeader already initialised on table "+e.nTable.id;e._fixedHeader=this;this._constructor()};d.extend(k.prototype,{enable:function(a){this.s.enable=a;this.c.header&&this._modeChange("in-place","header",!0);this.c.footer&&this.dom.tfoot.length&&this._modeChange("in-place","footer",!0);this.update()},headerOffset:function(a){a!==m&&(this.c.headerOffset=
a,this.update());return this.c.headerOffset},footerOffset:function(a){a!==m&&(this.c.footerOffset=a,this.update());return this.c.footerOffset},update:function(){this._positions();this._scroll(!0)},_constructor:function(){var a=this,b=this.s.dt;d(f).on("scroll"+this.s.namespace,function(){a._scroll()}).on("resize"+this.s.namespace,function(){a.s.position.windowHeight=d(f).height();a.update()});b.on("column-reorder.dt.dtfc column-visibility.dt.dtfc draw.dt.dtfc column-sizing.dt.dtfc",function(){a.update()});
b.on("destroy.dtfc",function(){b.off(".dtfc");d(f).off(a.s.namespace)});this._positions();this._scroll()},_clone:function(a,b){var e=this.s.dt,c=this.dom[a],g="header"===a?this.dom.thead:this.dom.tfoot;!b&&c.floating?c.floating.removeClass("fixedHeader-floating fixedHeader-locked"):(c.floating&&(c.placeholder.remove(),this._unsize(a),c.floating.children().detach(),c.floating.remove()),c.floating=d(e.table().node().cloneNode(!1)).css("table-layout","fixed").removeAttr("id").append(g).appendTo("body"),
c.placeholder=g.clone(!1),c.host.prepend(c.placeholder),this._matchWidths(c.placeholder,c.floating))},_matchWidths:function(a,b){var e=function(b){return d(b,a).map(function(){return d(this).width()}).toArray()},c=function(a,c){d(a,b).each(function(a){d(this).css({width:c[a],minWidth:c[a]})})},g=e("th"),e=e("td");c("th",g);c("td",e)},_unsize:function(a){var b=this.dom[a].floating;b&&("footer"===a||"header"===a&&!this.s.autoWidth)?d("th, td",b).css({width:"",minWidth:""}):b&&"header"===a&&d("th, td",
b).css("min-width","")},_horizontal:function(a,b){var e=this.dom[a],c=this.s.position,d=this.s.scrollLeft;e.floating&&d[a]!==b&&(e.floating.css("left",c.left-b),d[a]=b)},_modeChange:function(a,b,e){var c=this.dom[b],d=this.s.position;"in-place"===a?(c.placeholder&&(c.placeholder.remove(),c.placeholder=null),this._unsize(b),"header"===b?c.host.prepend(this.dom.thead):c.host.append(this.dom.tfoot),c.floating&&(c.floating.remove(),c.floating=null)):"in"===a?(this._clone(b,e),c.floating.addClass("fixedHeader-floating").css("header"===
b?"top":"bottom",this.c[b+"Offset"]).css("left",d.left+"px").css("width",d.width+"px"),"footer"===b&&c.floating.css("top","")):"below"===a?(this._clone(b,e),c.floating.addClass("fixedHeader-locked").css("top",d.tfootTop-d.theadHeight).css("left",d.left+"px").css("width",d.width+"px")):"above"===a&&(this._clone(b,e),c.floating.addClass("fixedHeader-locked").css("top",d.tbodyTop).css("left",d.left+"px").css("width",d.width+"px"));this.s.scrollLeft.header=-1;this.s.scrollLeft.footer=-1;this.s[b+"Mode"]=
a},_positions:function(){var a=this.s.dt.table(),b=this.s.position,e=this.dom,a=d(a.node()),c=a.children("thead"),g=a.children("tfoot"),e=e.tbody;b.visible=a.is(":visible");b.width=a.outerWidth();b.left=a.offset().left;b.theadTop=c.offset().top;b.tbodyTop=e.offset().top;b.theadHeight=b.tbodyTop-b.theadTop;g.length?(b.tfootTop=g.offset().top,b.tfootBottom=b.tfootTop+g.outerHeight(),b.tfootHeight=b.tfootBottom-b.tfootTop):(b.tfootTop=b.tbodyTop+e.outerHeight(),b.tfootBottom=b.tfootTop,b.tfootHeight=
b.tfootTop)},_scroll:function(a){var b=d(h).scrollTop(),e=d(h).scrollLeft(),c=this.s.position,g;this.s.enable&&(this.c.header&&(g=!c.visible||b<=c.theadTop-this.c.headerOffset?"in-place":b<=c.tfootTop-c.theadHeight-this.c.headerOffset?"in":"below",(a||g!==this.s.headerMode)&&this._modeChange(g,"header",a),this._horizontal("header",e)),this.c.footer&&this.dom.tfoot.length&&(b=!c.visible||b+c.windowHeight>=c.tfootBottom+this.c.footerOffset?"in-place":c.windowHeight+b>c.tbodyTop+c.tfootHeight+this.c.footerOffset?
"in":"above",(a||b!==this.s.footerMode)&&this._modeChange(b,"footer",a),this._horizontal("footer",e)))}});k.version="3.1.1";k.defaults={header:!0,footer:!1,headerOffset:0,footerOffset:0};d.fn.dataTable.FixedHeader=k;d.fn.DataTable.FixedHeader=k;d(h).on("init.dt.dtfh",function(a,b,e){"dt"===a.namespace&&(a=b.oInit.fixedHeader,e=l.defaults.fixedHeader,!a&&!e||b._fixedHeader||(e=d.extend({},e,a),!1!==a&&new k(b,e)))});l.Api.register("fixedHeader()",function(){});l.Api.register("fixedHeader.adjust()",
function(){return this.iterator("table",function(a){(a=a._fixedHeader)&&a.update()})});l.Api.register("fixedHeader.enable()",function(a){return this.iterator("table",function(b){(b=b._fixedHeader)&&b.enable(a!==m?a:!0)})});l.Api.register("fixedHeader.disable()",function(){return this.iterator("table",function(a){(a=a._fixedHeader)&&a.enable(!1)})});d.each(["header","footer"],function(a,b){l.Api.register("fixedHeader."+b+"Offset()",function(a){var c=this.context;return a===m?c.length&&c[0]._fixedHeader?
c[0]._fixedHeader[b+"Offset"]():m:this.iterator("table",function(c){if(c=c._fixedHeader)c[b+"Offset"](a)})})});return k});
