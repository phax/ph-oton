(function(D){var b=function(a){return{hide:function(){a.style.display="none";return this},attach:function(d,c){a.addEventListener?a.addEventListener(d,c,!1):a.attachEvent&&a.attachEvent("on"+d,c);return function(){b(a).detach(d,c)}},detach:function(b,c){a.removeEventListener?a.removeEventListener(b,c,!1):a.attachEvent&&a.detachEvent("on"+b,c);return this},contains:function(b){return b?a===b?!0:a.contains?a.contains(b):!!(b.compareDocumentPosition(a)&8):!1},insertBefore:function(b){b.parentNode.insertBefore(a,
b);return this},remove:function(){a.parentNode.removeChild(a);return this},css:function(d){if(null==a.style)throw new b.Error("Can't apply style to node as it is not on the HTMLElement prototype chain!");null!=d.opacity&&"string"!==typeof a.style.opacity&&"undefined"!==typeof a.filters&&(d.filter="alpha(opacity="+Math.round(100*d.opacity)+")");b.extend(a.style,d);return this},hasClass:function(b,c){var e=new RegExp("(^| )"+b+"( |$)");return e.test(a.className)||!(!c||!e.test(a.parentNode.className))},
addClass:function(d){b(a).hasClass(d)||(a.className+=" "+d);return this},removeClass:function(b){a.className=a.className.replace(new RegExp("(^| )"+b+"( |$)")," ").replace(/^\s+|\s+$/g,"");return this},getByClass:function(d,c){var e,f=[];if(c&&a.querySelector)return a.querySelector("."+d);if(a.querySelectorAll)return a.querySelectorAll("."+d);e=a.getElementsByTagName("*");b.each(e,function(a,c){b(c).hasClass(d)&&f.push(c)});return c?f[0]:f},getFirstByClass:function(d){return b(a).getByClass(d,!0)},
children:function(){for(var b=[],c=a.firstChild;c;)1===c.nodeType&&b.push(c),c=c.nextSibling;return b},setText:function(b){a.innerText=b;a.textContent=b;return this},clearText:function(){return b(a).setText("")},hasAttribute:function(b){if(a.hasAttribute)return a.hasAttribute(b)?null==/^false$/i.exec(a.getAttribute(b)):!1;b=a[b];return void 0===b?!1:null==/^false$/i.exec(b)}}};(function(){b.canvasToBlob=function(a,d,c){return b.dataUriToBlob(a.toDataURL(d,c))};b.dataUriToBlob=function(a){var d,c,
e;d=0<=a.split(",")[0].indexOf("base64")?atob(a.split(",")[1]):decodeURI(a.split(",")[1]);e=a.split(",")[0].split(":")[1].split(";")[0];a=new ArrayBuffer(d.length);c=new Uint8Array(a);b.each(d,function(a,b){c[a]=b.charCodeAt(0)});return function(a,b){var c=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;return(c=c&&new c)?(c.append(a),c.getBlob(b)):new Blob([a],{type:b})}(a,e)};b.log=function(a,b){if(window.console)if(b&&"info"!==b)if(window.console[b])window.console[b](a);
else window.console.log("<"+b+"> "+a);else window.console.log(a)};b.isObject=function(a){return a&&!a.nodeType&&"[object Object]"===Object.prototype.toString.call(a)};b.isFunction=function(a){return"function"===typeof a};b.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)||a&&window.ArrayBuffer&&a.buffer&&a.buffer.constructor===ArrayBuffer};b.isItemList=function(a){return"[object DataTransferItemList]"===Object.prototype.toString.call(a)};b.isNodeList=function(a){return"[object NodeList]"===
Object.prototype.toString.call(a)||a.item&&a.namedItem};b.isString=function(a){return"[object String]"===Object.prototype.toString.call(a)};b.trimStr=function(a){return String.prototype.trim?a.trim():a.replace(/^\s+|\s+$/g,"")};b.format=function(a){var d=Array.prototype.slice.call(arguments,1),c=a,e=c.indexOf("{}");b.each(d,function(a,b){var d=c.substring(0,e),k=c.substring(e+2);c=d+b+k;e=c.indexOf("{}",e+b.length);if(0>e)return!1});return c};b.isFile=function(a){return window.File&&"[object File]"===
Object.prototype.toString.call(a)};b.isFileList=function(a){return window.FileList&&"[object FileList]"===Object.prototype.toString.call(a)};b.isFileOrInput=function(a){return b.isFile(a)||b.isInput(a)};b.isInput=function(a,b){var c=function(a){a=a.toLowerCase();return b?"file"!==a:"file"===a};return window.HTMLInputElement&&"[object HTMLInputElement]"===Object.prototype.toString.call(a)&&a.type&&c(a.type)||a.tagName&&"input"===a.tagName.toLowerCase()&&a.type&&c(a.type)?!0:!1};b.isBlob=function(a){if(window.Blob&&
"[object Blob]"===Object.prototype.toString.call(a))return!0};b.isXhrUploadSupported=function(){var a=document.createElement("input");a.type="file";return void 0!==a.multiple&&"undefined"!==typeof File&&"undefined"!==typeof FormData&&"undefined"!==typeof b.createXhrInstance().upload};b.createXhrInstance=function(){if(window.XMLHttpRequest)return new XMLHttpRequest;try{return new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(a){return b.log("Neither XHR or ActiveX are supported!","error"),null}};b.isFolderDropSupported=
function(a){return a.items&&0<a.items.length&&a.items[0].webkitGetAsEntry};b.isFileChunkingSupported=function(){return!b.androidStock()&&b.isXhrUploadSupported()&&(void 0!==File.prototype.slice||void 0!==File.prototype.webkitSlice||void 0!==File.prototype.mozSlice)};b.sliceBlob=function(a,b,c){return(a.slice||a.mozSlice||a.webkitSlice).call(a,b,c)};b.arrayBufferToHex=function(a){var d="";a=new Uint8Array(a);b.each(a,function(a,b){var f=b.toString(16);2>f.length&&(f="0"+f);d+=f});return d};b.readBlobToHex=
function(a,d,c){a=b.sliceBlob(a,d,d+c);var e=new FileReader,f=new b.Promise;e.onload=function(){f.success(b.arrayBufferToHex(e.result))};e.onerror=f.failure;e.readAsArrayBuffer(a);return f};b.extend=function(a,d,c){b.each(d,function(d,f){c&&b.isObject(f)?(void 0===a[d]&&(a[d]={}),b.extend(a[d],f,!0)):a[d]=f});return a};b.override=function(a,d){var c={},e=d(c);b.each(e,function(b,d){void 0!==a[b]&&(c[b]=a[b]);a[b]=d});return a};b.indexOf=function(a,b,c){if(a.indexOf)return a.indexOf(b,c);c=c||0;var e=
a.length;for(0>c&&(c+=e);c<e;c+=1)if(a.hasOwnProperty(c)&&a[c]===b)return c;return-1};b.getUniqueId=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})};b.ie=function(){return-1!==navigator.userAgent.indexOf("MSIE")||-1!==navigator.userAgent.indexOf("Trident")};b.ie7=function(){return-1!==navigator.userAgent.indexOf("MSIE 7")};b.ie8=function(){return-1!==navigator.userAgent.indexOf("MSIE 8")};b.ie10=function(){return-1!==
navigator.userAgent.indexOf("MSIE 10")};b.ie11=function(){return b.ie()&&-1!==navigator.userAgent.indexOf("rv:11")};b.edge=function(){return 0<=navigator.userAgent.indexOf("Edge")};b.safari=function(){return void 0!==navigator.vendor&&-1!==navigator.vendor.indexOf("Apple")};b.chrome=function(){return void 0!==navigator.vendor&&-1!==navigator.vendor.indexOf("Google")};b.opera=function(){return void 0!==navigator.vendor&&-1!==navigator.vendor.indexOf("Opera")};b.firefox=function(){return!b.edge()&&
!b.ie11()&&-1!==navigator.userAgent.indexOf("Mozilla")&&void 0!==navigator.vendor&&""===navigator.vendor};b.windows=function(){return"Win32"===navigator.platform};b.android=function(){return-1!==navigator.userAgent.toLowerCase().indexOf("android")};b.androidStock=function(){return b.android()&&0>navigator.userAgent.toLowerCase().indexOf("chrome")};b.ios6=function(){return b.ios()&&-1!==navigator.userAgent.indexOf(" OS 6_")};b.ios7=function(){return b.ios()&&-1!==navigator.userAgent.indexOf(" OS 7_")};
b.ios8=function(){return b.ios()&&-1!==navigator.userAgent.indexOf(" OS 8_")};b.ios800=function(){return b.ios()&&-1!==navigator.userAgent.indexOf(" OS 8_0 ")};b.ios=function(){return-1!==navigator.userAgent.indexOf("iPad")||-1!==navigator.userAgent.indexOf("iPod")||-1!==navigator.userAgent.indexOf("iPhone")};b.iosChrome=function(){return b.ios()&&-1!==navigator.userAgent.indexOf("CriOS")};b.iosSafari=function(){return b.ios()&&!b.iosChrome()&&-1!==navigator.userAgent.indexOf("Safari")};b.iosSafariWebView=
function(){return b.ios()&&!b.iosChrome()&&!b.iosSafari()};b.preventDefault=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1};b.toElement=function(){var a=document.createElement("div");return function(b){a.innerHTML=b;b=a.firstChild;a.removeChild(b);return b}}();b.each=function(a,d){var c,e;if(a)if(window.Storage&&a.constructor===window.Storage)for(c=0;c<a.length&&(e=d(a.key(c),a.getItem(a.key(c))),!1!==e);c++);else if(b.isArray(a)||b.isItemList(a)||b.isNodeList(a))for(c=0;c<a.length&&
(e=d(c,a[c]),!1!==e);c++);else if(b.isString(a))for(c=0;c<a.length&&(e=d(c,a.charAt(c)),!1!==e);c++);else for(c in a)if(Object.prototype.hasOwnProperty.call(a,c)&&(e=d(c,a[c]),!1===e))break};b.bind=function(a,d){if(b.isFunction(a)){var c=Array.prototype.slice.call(arguments,2);return function(){var e=b.extend([],c);arguments.length&&(e=e.concat(Array.prototype.slice.call(arguments)));return a.apply(d,e)}}throw Error("first parameter must be a function!");};b.obj2url=function(a,d,c){var e=[],f="&",
g=function(a,c){var g=d?/\[\]$/.test(d)?d:d+"["+c+"]":c;"undefined"!==g&&"undefined"!==c&&e.push("object"===typeof a?b.obj2url(a,g,!0):"[object Function]"===Object.prototype.toString.call(a)?encodeURIComponent(g)+"="+encodeURIComponent(a()):encodeURIComponent(g)+"="+encodeURIComponent(a))};!c&&d?(f=/\?/.test(d)?/\?$/.test(d)?"":"&":"?",e.push(d),e.push(b.obj2url(a))):"[object Array]"===Object.prototype.toString.call(a)&&"undefined"!==typeof a?b.each(a,function(a,b){g(b,a)}):"undefined"!==typeof a&&
null!==a&&"object"===typeof a?b.each(a,function(a,b){g(b,a)}):e.push(encodeURIComponent(d)+"="+encodeURIComponent(a));return d?e.join(f):e.join(f).replace(/^&/,"").replace(/%20/g,"+")};b.obj2FormData=function(a,d,c){d||(d=new FormData);b.each(a,function(a,f){a=c?c+"["+a+"]":a;b.isObject(f)?b.obj2FormData(f,d,a):b.isFunction(f)?d.append(a,f()):d.append(a,f)});return d};b.obj2Inputs=function(a,d){var c;d||(d=document.createElement("form"));b.obj2FormData(a,{append:function(a,b){c=document.createElement("input");
c.setAttribute("name",a);c.setAttribute("value",b);d.appendChild(c)}});return d};b.parseJson=function(a){return window.JSON&&b.isFunction(JSON.parse)?JSON.parse(a):eval("("+a+")")};b.getExtension=function(a){var b=a.lastIndexOf(".")+1;if(0<b)return a.substr(b,a.length-b)};b.getFilename=function(a){return b.isInput(a)?a.value.replace(/.*(\/|\\)/,""):b.isFile(a)&&null!==a.fileName&&void 0!==a.fileName?a.fileName:a.name};b.DisposeSupport=function(){var a=[];return{dispose:function(){var b;do(b=a.shift())&&
b();while(b)},attach:function(){this.addDisposer(b(arguments[0]).attach.apply(this,Array.prototype.slice.call(arguments,1)))},addDisposer:function(b){a.push(b)}}}})();(function(){"function"===typeof define&&define.amd?define(function(){return b}):"undefined"!==typeof module&&module.exports?module.exports=b:D.qq=b})();(function(){b.Error=function(a){this.message="[Fine Uploader "+b.version+"] "+a};b.Error.prototype=Error()})();b.version="5.11.10";b.supportedFeatures=function(){function a(){var a=document.createElement("span");
return("draggable"in a||"ondragstart"in a&&"ondrop"in a)&&!b.android()&&!b.ios()}var d,c,e,f,g,h,k,l,n,m,q,p,t,w,u;c=(f=(d=function(){var a=!0,c;try{c=document.createElement("input"),c.type="file",b(c).hide(),c.disabled&&(a=!1)}catch(d){a=!1}return a}())&&b.isXhrUploadSupported())&&!b.androidStock();g=(e=f&&a())&&(b.chrome()||b.opera())&&void 0!==navigator.userAgent.match(/Chrome\/[2][1-9]|Chrome\/[3-9][0-9]/);h=f&&b.isFileChunkingSupported();if(k=f&&h)try{k=!!window.localStorage&&b.isFunction(window.localStorage.setItem)}catch(v){k=
!1}l=f&&(b.chrome()||b.opera())&&void 0!==navigator.userAgent.match(/Chrome\/[1][4-9]|Chrome\/[2-9][0-9]/);n=d&&(void 0!==window.postMessage||f);q=window.XMLHttpRequest?void 0!==b.createXhrInstance().withCredentials:!1;m=void 0!==window.XDomainRequest;p=window.XMLHttpRequest&&void 0!==b.createXhrInstance().withCredentials?!0:void 0!==window.XDomainRequest;t=void 0!==document.createElement("input").webkitdirectory;w=f&&void 0!==window.FileReader;u=f?!b.androidStock()&&!b.iosChrome():!1;return{ajaxUploading:f,
blobUploading:c,canDetermineSize:f,chunking:h,deleteFileCors:p,deleteFileCorsXdr:m,deleteFileCorsXhr:q,dialogElement:!!window.HTMLDialogElement,fileDrop:e,folderDrop:g,folderSelection:t,imagePreviews:w,imageValidation:w,itemSizeValidation:f,pause:h,progressBar:u,resume:k,scaling:w&&c,tiffPreviews:b.safari(),unlimitedScaledImageSize:!b.ios(),uploading:d,uploadCors:n,uploadCustomHeaders:f,uploadNonMultipart:f,uploadViaPaste:l}}();b.isGenericPromise=function(a){return!!(a&&a.then&&b.isFunction(a.then))};
b.Promise=function(){var a,d,c=[],e=[],f=[],g=0;b.extend(this,{then:function(b,f){0===g?(b&&c.push(b),f&&e.push(f)):-1===g?f&&f.apply(null,d):b&&b.apply(null,a);return this},done:function(b){0===g?f.push(b):b.apply(null,void 0===d?a:d);return this},success:function(){g=1;a=arguments;c.length&&b.each(c,function(b,c){c.apply(null,a)});f.length&&b.each(f,function(b,c){c.apply(null,a)});return this},failure:function(){g=-1;d=arguments;e.length&&b.each(e,function(a,b){b.apply(null,d)});f.length&&b.each(f,
function(a,b){b.apply(null,d)});return this}})};b.BlobProxy=function(a,d){b.extend(this,{referenceBlob:a,create:function(){return d(a)}})};b.UploadButton=function(a){function d(){var a=document.createElement("input");a.setAttribute(b.UploadButton.BUTTON_ID_ATTR_NAME,h);a.setAttribute("title",f.title);c.setMultiple(f.multiple,a);f.folders&&b.supportedFeatures.folderSelection&&a.setAttribute("webkitdirectory","");f.acceptFiles&&a.setAttribute("accept",f.acceptFiles);a.setAttribute("type","file");a.setAttribute("name",
f.name);b(a).css({position:"absolute",right:0,top:0,fontFamily:"Arial",fontSize:b.ie()&&!b.ie8()?"3500px":"118px",margin:0,padding:0,cursor:"pointer",opacity:0});!b.ie7()&&b(a).css({height:"100%"});f.element.appendChild(a);e.attach(a,"change",function(){f.onChange(a)});e.attach(a,"mouseover",function(){b(f.element).addClass(f.hoverClass)});e.attach(a,"mouseout",function(){b(f.element).removeClass(f.hoverClass)});e.attach(a,"focus",function(){b(f.element).addClass(f.focusClass)});e.attach(a,"blur",
function(){b(f.element).removeClass(f.focusClass)});return a}var c=this,e=new b.DisposeSupport,f={acceptFiles:null,element:null,focusClass:"qq-upload-button-focus",folders:!1,hoverClass:"qq-upload-button-hover",ios8BrowserCrashWorkaround:!1,multiple:!1,name:"qqfile",onChange:function(a){},title:null},g,h;b.extend(f,a);h=b.getUniqueId();b(f.element).css({position:"relative",overflow:"hidden",direction:"ltr"});b.extend(this,{getInput:function(){return g},getButtonId:function(){return h},setMultiple:function(a,
c){var d=c||this.getInput();f.ios8BrowserCrashWorkaround&&b.ios8()&&(b.iosChrome()||b.iosSafariWebView())?d.setAttribute("multiple",""):a?d.setAttribute("multiple",""):d.removeAttribute("multiple")},setAcceptFiles:function(a){a!==f.acceptFiles&&g.setAttribute("accept",a)},reset:function(){g.parentNode&&b(g).remove();b(f.element).removeClass(f.focusClass);g=null;g=d()}});g=d()};b.UploadButton.BUTTON_ID_ATTR_NAME="qq-button-id";b.UploadData=function(a){function d(a){if(b.isArray(a)){var c=[];b.each(a,
function(a,b){c.push(f[b])});return c}return f[a]}function c(a){if(b.isArray(a)){var c=[];b.each(a,function(a,b){c.push(f[g[b]])});return c}return f[g[a]]}function e(a){var c=[];a=[].concat(a);b.each(a,function(a,d){var e=h[d];void 0!==e&&b.each(e,function(a,b){c.push(f[b])})});return c}var f=[],g={},h={},k={},l={};b.extend(this,{addFile:function(c){var d=c.status||b.status.SUBMITTING,e=f.push({name:c.name,originalName:c.name,uuid:c.uuid,size:null==c.size?-1:c.size,status:d})-1;c.batchId&&(f[e].batchId=
c.batchId,void 0===l[c.batchId]&&(l[c.batchId]=[]),l[c.batchId].push(e));c.proxyGroupId&&(f[e].proxyGroupId=c.proxyGroupId,void 0===k[c.proxyGroupId]&&(k[c.proxyGroupId]=[]),k[c.proxyGroupId].push(e));f[e].id=e;g[c.uuid]=e;void 0===h[d]&&(h[d]=[]);h[d].push(e);a.onStatusChange(e,null,d);return e},retrieve:function(a){if(b.isObject(a)&&f.length){if(void 0!==a.id)return d(a.id);if(void 0!==a.uuid)return c(a.uuid);if(a.status)return e(a.status)}else return b.extend([],f,!0)},reset:function(){f=[];g=
{};h={};l={}},setStatus:function(c,d){var e=f[c].status,g=b.indexOf(h[e],c);h[e].splice(g,1);f[c].status=d;void 0===h[d]&&(h[d]=[]);h[d].push(c);a.onStatusChange(c,e,d)},uuidChanged:function(a,b){var c=f[a].uuid;f[a].uuid=b;g[b]=a;delete g[c]},updateName:function(a,b){f[a].name=b},updateSize:function(a,b){f[a].size=b},setParentId:function(a,b){f[a].parentId=b},getIdsInProxyGroup:function(a){return(a=f[a].proxyGroupId)?k[a]:[]},getIdsInBatch:function(a){return l[f[a].batchId]}})};b.status={SUBMITTING:"submitting",
SUBMITTED:"submitted",REJECTED:"rejected",QUEUED:"queued",CANCELED:"canceled",PAUSED:"paused",UPLOADING:"uploading",UPLOAD_RETRYING:"retrying upload",UPLOAD_SUCCESSFUL:"upload successful",UPLOAD_FAILED:"upload failed",DELETE_FAILED:"delete failed",DELETING:"deleting",DELETED:"deleted"};(function(){b.basePublicApi={addBlobs:function(a,b,c){this.addFiles(a,b,c)},addInitialFiles:function(a){var d=this;b.each(a,function(a,b){d._addCannedFile(b)})},addFiles:function(a,d,c){this._maybeHandleIos8SafariWorkaround();
var e=0===this._storedIds.length?b.getUniqueId():this._currentBatchId,f=b.bind(function(a){this._handleNewFile({blob:a,name:this._options.blobs.defaultName},e,m)},this),g=b.bind(function(a){this._handleNewFile(a,e,m)},this),h=b.bind(function(a){a=b.canvasToBlob(a);this._handleNewFile({blob:a,name:this._options.blobs.defaultName+".png"},e,m)},this),k=b.bind(function(a){var c=b.canvasToBlob(a.canvas,a.type,a.quality&&a.quality/100);this._handleNewFile({blob:c,name:a.name},e,m)},this),l=b.bind(function(a){if(b.isInput(a)&&
b.supportedFeatures.ajaxUploading){a=Array.prototype.slice.call(a.files);var c=this;b.each(a,function(a,b){c._handleNewFile(b,e,m)})}else this._handleNewFile(a,e,m)},this),n=this,m=[];this._currentBatchId=e;a&&(b.isFileList(a)&&(a=Array.prototype.slice.call(a)),a=[].concat(a),b.each(a,function(a,c){b.isFileOrInput(c)?l(c):b.isBlob(c)?f(c):b.isObject(c)?c.blob&&c.name?g(c):c.canvas&&c.name&&k(c):c.tagName&&"canvas"===c.tagName.toLowerCase()?h(c):n.log(c+" is not a valid file container!  Ignoring!",
"warn")}),this.log("Received "+m.length+" files."),this._prepareItemsForUpload(m,d,c))},cancel:function(a){this._handler.cancel(a)},cancelAll:function(){var a=[],d=this;b.extend(a,this._storedIds);b.each(a,function(a,b){d.cancel(b)});this._handler.cancelAll()},clearStoredFiles:function(){this._storedIds=[]},continueUpload:function(a){var d=this._uploadData.retrieve({id:a});if(!b.supportedFeatures.pause||!this._options.chunking.enabled)return!1;if(d.status===b.status.PAUSED)return this.log(b.format("Paused file ID {} ({}) will be continued.  Not paused.",
a,this.getName(a))),this._uploadFile(a),!0;this.log(b.format("Ignoring continue for file ID {} ({}).  Not paused.",a,this.getName(a)),"error");return!1},deleteFile:function(a){return this._onSubmitDelete(a)},doesExist:function(a){return this._handler.isValid(a)},drawThumbnail:function(a,d,c,e,f){var g=new b.Promise,h;this._imageGenerator?(h=this._thumbnailUrls[a],c={customResizeFunction:f,maxSize:0<c?c:null,scale:0<c},!e&&b.supportedFeatures.imagePreviews&&(h=this.getFile(a)),null==h?g.failure({container:d,
error:"File or URL not found."}):this._imageGenerator.generate(h,d,c).then(function(a){g.success(a)},function(a,b){g.failure({container:a,error:b||"Problem generating thumbnail"})})):g.failure({container:d,error:"Missing image generator module"});return g},getButton:function(a){return this._getButton(this._buttonIdsForFileIds[a])},getEndpoint:function(a){return this._endpointStore.get(a)},getFile:function(a){return this._handler.getFile(a)||null},getInProgress:function(){return this._uploadData.retrieve({status:[b.status.UPLOADING,
b.status.UPLOAD_RETRYING,b.status.QUEUED]}).length},getName:function(a){return this._uploadData.retrieve({id:a}).name},getParentId:function(a){a=this.getUploads({id:a});var b=null;a&&void 0!==a.parentId&&(b=a.parentId);return b},getResumableFilesData:function(){return this._handler.getResumableFilesData()},getSize:function(a){return this._uploadData.retrieve({id:a}).size},getNetUploads:function(){return this._netUploaded},getRemainingAllowedItems:function(){var a=this._currentItemLimit;return 0<a?
a-this._netUploadedOrQueued:null},getUploads:function(a){return this._uploadData.retrieve(a)},getUuid:function(a){return this._uploadData.retrieve({id:a}).uuid},log:function(a,d){!this._options.debug||d&&"info"!==d?d&&"info"!==d&&b.log("[Fine Uploader "+b.version+"] "+a,d):b.log("[Fine Uploader "+b.version+"] "+a)},pauseUpload:function(a){var d=this._uploadData.retrieve({id:a});if(!b.supportedFeatures.pause||!this._options.chunking.enabled)return!1;if(0<=b.indexOf([b.status.UPLOADING,b.status.UPLOAD_RETRYING],
d.status)){if(this._handler.pause(a))return this._uploadData.setStatus(a,b.status.PAUSED),!0;this.log(b.format("Unable to pause file ID {} ({}).",a,this.getName(a)),"error")}else this.log(b.format("Ignoring pause for file ID {} ({}).  Not in progress.",a,this.getName(a)),"error");return!1},reset:function(){this.log("Resetting uploader...");this._handler.reset();this._storedIds=[];this._autoRetries=[];this._retryTimeouts=[];this._preventRetries=[];this._thumbnailUrls=[];b.each(this._buttons,function(a,
b){b.reset()});this._paramsStore.reset();this._endpointStore.reset();this._netUploaded=this._netUploadedOrQueued=0;this._uploadData.reset();this._buttonIdsForFileIds=[];this._pasteHandler&&this._pasteHandler.reset();this._options.session.refreshOnReset&&this._refreshSessionData();this._succeededSinceLastAllComplete=[];this._failedSinceLastAllComplete=[];this._totalProgress&&this._totalProgress.reset()},retry:function(a){return this._manualRetry(a)},scaleImage:function(a,d){return b.Scaler.prototype.scaleImage(a,
d,{log:b.bind(this.log,this),getFile:b.bind(this.getFile,this),uploadData:this._uploadData})},setCustomHeaders:function(a,b){this._customHeadersStore.set(a,b)},setDeleteFileCustomHeaders:function(a,b){this._deleteFileCustomHeadersStore.set(a,b)},setDeleteFileEndpoint:function(a,b){this._deleteFileEndpointStore.set(a,b)},setDeleteFileParams:function(a,b){this._deleteFileParamsStore.set(a,b)},setEndpoint:function(a,b){this._endpointStore.set(a,b)},setForm:function(a){this._updateFormSupportAndParams(a)},
setItemLimit:function(a){this._currentItemLimit=a},setName:function(a,b){this._uploadData.updateName(a,b)},setParams:function(a,b){this._paramsStore.set(a,b)},setUuid:function(a,b){return this._uploadData.uuidChanged(a,b)},uploadStoredFiles:function(){0===this._storedIds.length?this._itemError("noFilesError"):this._uploadStoredFiles()}};b.basePrivateApi={_addCannedFile:function(a){var d=this._uploadData.addFile({uuid:a.uuid,name:a.name,size:a.size,status:b.status.UPLOAD_SUCCESSFUL});a.deleteFileEndpoint&&
this.setDeleteFileEndpoint(a.deleteFileEndpoint,d);a.deleteFileParams&&this.setDeleteFileParams(a.deleteFileParams,d);a.thumbnailUrl&&(this._thumbnailUrls[d]=a.thumbnailUrl);this._netUploaded++;this._netUploadedOrQueued++;return d},_annotateWithButtonId:function(a,d){b.isFile(a)&&(a.qqButtonId=this._getButtonId(d))},_batchError:function(a){this._options.callbacks.onError(null,null,a,void 0)},_createDeleteHandler:function(){var a=this;return new b.DeleteFileAjaxRequester({method:this._options.deleteFile.method.toUpperCase(),
maxConnections:this._options.maxConnections,uuidParamName:this._options.request.uuidName,customHeaders:this._deleteFileCustomHeadersStore,paramsStore:this._deleteFileParamsStore,endpointStore:this._deleteFileEndpointStore,cors:this._options.cors,log:b.bind(a.log,a),onDelete:function(b){a._onDelete(b);a._options.callbacks.onDelete(b)},onDeleteComplete:function(b,c,e){a._onDeleteComplete(b,c,e);a._options.callbacks.onDeleteComplete(b,c,e)}})},_createPasteHandler:function(){var a=this;return new b.PasteSupport({targetElement:this._options.paste.targetElement,
callbacks:{log:b.bind(a.log,a),pasteReceived:function(d){a._handleCheckedCallback({name:"onPasteReceived",callback:b.bind(a._options.callbacks.onPasteReceived,a,d),onSuccess:b.bind(a._handlePasteSuccess,a,d),identifier:"pasted image"})}}})},_createStore:function(a,d){var c={},e=a,f={},g=d,h=function(a){return b.isObject(a)?b.extend({},a):a};return{set:function(a,b){null==b?(c={},e=h(a)):c[b]=h(a)},get:function(a){var d;d=null!=a&&c[a]?c[a]:h(e);g&&b.isObject(d)&&b.extend(d,b.isFunction(g)?g():g);
f[a]&&b.extend(d,f[a]);return h(d)},addReadOnly:function(a,d){b.isObject(c)&&(null===a?b.isFunction(d)?g=d:(g=g||{},b.extend(g,d)):(f[a]=f[a]||{},b.extend(f[a],d)))},remove:function(a){return delete c[a]},reset:function(){c={};f={};e=a}}},_createUploadDataTracker:function(){var a=this;return new b.UploadData({getName:function(b){return a.getName(b)},getUuid:function(b){return a.getUuid(b)},getSize:function(b){return a.getSize(b)},onStatusChange:function(b,c,e){a._onUploadStatusChange(b,c,e);a._options.callbacks.onStatusChange(b,
c,e);a._maybeAllComplete(b,e);a._totalProgress&&setTimeout(function(){a._totalProgress.onStatusChange(b,c,e)},0)}})},_createUploadButton:function(a){var d=this,c=a.allowedExtensions||this._options.validation.allowedExtensions,e;e=new b.UploadButton({acceptFiles:a.accept||this._options.validation.acceptFiles,element:a.element,focusClass:this._options.classes.buttonFocus,folders:a.folders,hoverClass:this._options.classes.buttonHover,ios8BrowserCrashWorkaround:this._options.workarounds.ios8BrowserCrash,
multiple:b.supportedFeatures.ajaxUploading?d._options.workarounds.iosEmptyVideos&&b.ios()&&!b.ios6()&&d._isAllowedExtension(c,".mov")?!1:void 0===a.multiple?d._options.multiple:a.multiple:!1,name:this._options.request.inputName,onChange:function(a){d._onInputChange(a)},title:null==a.title?this._options.text.fileInputTitle:a.title});this._disposeSupport.addDisposer(function(){e.dispose()});d._buttons.push(e);return e},_createUploadHandler:function(a,d){var c=this,e={},f={debug:this._options.debug,
maxConnections:this._options.maxConnections,cors:this._options.cors,paramsStore:this._paramsStore,endpointStore:this._endpointStore,chunking:this._options.chunking,resume:this._options.resume,blobs:this._options.blobs,log:b.bind(c.log,c),preventRetryParam:this._options.retry.preventRetryResponseProperty,onProgress:function(a,b,d,f){if(!(0>d||0>f)){if(e[a]){if(e[a].loaded!==d||e[a].total!==f)c._onProgress(a,b,d,f),c._options.callbacks.onProgress(a,b,d,f)}else c._onProgress(a,b,d,f),c._options.callbacks.onProgress(a,
b,d,f);e[a]={loaded:d,total:f}}},onComplete:function(a,d,f,l){delete e[a];var n=c.getUploads({id:a}).status;if(n!==b.status.UPLOAD_SUCCESSFUL&&n!==b.status.UPLOAD_FAILED)if(n=c._onComplete(a,d,f,l),n instanceof b.Promise)n.done(function(){c._options.callbacks.onComplete(a,d,f,l)});else c._options.callbacks.onComplete(a,d,f,l)},onCancel:function(a,d,e){var f=new b.Promise;c._handleCheckedCallback({name:"onCancel",callback:b.bind(c._options.callbacks.onCancel,c,a,d),onFailure:f.failure,onSuccess:function(){e.then(function(){c._onCancel(a,
d)});f.success()},identifier:a});return f},onUploadPrep:b.bind(this._onUploadPrep,this),onUpload:function(a,b){c._onUpload(a,b);c._options.callbacks.onUpload(a,b)},onUploadChunk:function(a,b,d){c._onUploadChunk(a,d);c._options.callbacks.onUploadChunk(a,b,d)},onUploadChunkSuccess:function(a,b,d,e){c._options.callbacks.onUploadChunkSuccess.apply(c,arguments)},onResume:function(a,b,d){return c._options.callbacks.onResume(a,b,d)},onAutoRetry:function(a,b,d,e){return c._onAutoRetry.apply(c,arguments)},
onUuidChanged:function(a,b){c.log("Server requested UUID change from '"+c.getUuid(a)+"' to '"+b+"'");c.setUuid(a,b)},getName:b.bind(c.getName,c),getUuid:b.bind(c.getUuid,c),getSize:b.bind(c.getSize,c),setSize:b.bind(c._setSize,c),getDataByUuid:function(a){return c.getUploads({uuid:a})},isQueued:function(a){a=c.getUploads({id:a}).status;return a===b.status.QUEUED||a===b.status.SUBMITTED||a===b.status.UPLOAD_RETRYING||a===b.status.PAUSED},getIdsInProxyGroup:c._uploadData.getIdsInProxyGroup,getIdsInBatch:c._uploadData.getIdsInBatch};
b.each(this._options.request,function(a,b){f[a]=b});f.customHeaders=this._customHeadersStore;a&&b.each(a,function(a,b){f[a]=b});return new b.UploadHandlerController(f,d)},_fileOrBlobRejected:function(a){this._netUploadedOrQueued--;this._uploadData.setStatus(a,b.status.REJECTED)},_formatSize:function(a){var b=-1;do a/=1E3,b++;while(999<a);return Math.max(a,.1).toFixed(1)+this._options.text.sizeSymbols[b]},_generateExtraButtonSpecs:function(){var a=this;this._extraButtonSpecs={};b.each(this._options.extraButtons,
function(d,c){var e=c.multiple,f=b.extend({},a._options.validation,!0),g=b.extend({},c);void 0===e&&(e=a._options.multiple);g.validation&&b.extend(f,c.validation,!0);b.extend(g,{multiple:e,validation:f},!0);a._initExtraButton(g)})},_getButton:function(a){var b=this._extraButtonSpecs[a];if(b)return b.element;if(a===this._defaultButtonId)return this._options.button},_getButtonId:function(a){var d;a instanceof b.BlobProxy&&(a=a.referenceBlob);if(a&&!b.isBlob(a)){if(b.isFile(a))return a.qqButtonId;if("input"===
a.tagName.toLowerCase()&&"file"===a.type.toLowerCase())return a.getAttribute(b.UploadButton.BUTTON_ID_ATTR_NAME);a=a.getElementsByTagName("input");b.each(a,function(a,b){if("file"===b.getAttribute("type"))return d=b,!1});if(d)return d.getAttribute(b.UploadButton.BUTTON_ID_ATTR_NAME)}},_getNotFinished:function(){return this._uploadData.retrieve({status:[b.status.UPLOADING,b.status.UPLOAD_RETRYING,b.status.QUEUED,b.status.SUBMITTING,b.status.SUBMITTED,b.status.PAUSED]}).length},_getValidationBase:function(a){return(a=
this._extraButtonSpecs[a])?a.validation:this._options.validation},_getValidationDescriptor:function(a){return a.file instanceof b.BlobProxy?{name:b.getFilename(a.file.referenceBlob),size:a.file.referenceBlob.size}:{name:this.getUploads({id:a.id}).name,size:this.getUploads({id:a.id}).size}},_getValidationDescriptors:function(a){var d=this,c=[];b.each(a,function(a,b){c.push(d._getValidationDescriptor(b))});return c},_handleCameraAccess:function(){if(this._options.camera.ios&&b.ios()){var a=this._options.camera.button,
d=a?this._getButtonId(a):this._defaultButtonId,c=this._options;d&&d!==this._defaultButtonId&&(c=this._extraButtonSpecs[d]);c.multiple=!1;c.validation.acceptFiles=null===c.validation.acceptFiles?"image/*;capture=camera":c.validation.acceptFiles+",image/*;capture=camera";b.each(this._buttons,function(a,b){if(b.getButtonId()===d)return b.setMultiple(c.multiple),b.setAcceptFiles(c.acceptFiles),!1})}},_handleCheckedCallback:function(a){var d=this,c=a.callback();if(b.isGenericPromise(c))return this.log(a.name+
" - waiting for "+a.name+" promise to be fulfilled for "+a.identifier),c.then(function(b){d.log(a.name+" promise success for "+a.identifier);a.onSuccess(b)},function(){a.onFailure?(d.log(a.name+" promise failure for "+a.identifier),a.onFailure()):d.log(a.name+" promise failure for "+a.identifier)});if(!1!==c)a.onSuccess(c);else a.onFailure?(this.log(a.name+" - return value was 'false' for "+a.identifier+".  Invoking failure callback."),a.onFailure()):this.log(a.name+" - return value was 'false' for "+
a.identifier+".  Will not proceed.");return c},_handleNewFile:function(a,d,c){var e=this,f=b.getUniqueId(),g=-1,h=b.getFilename(a);a=a.blob||a;var k=this._customNewFileHandler?this._customNewFileHandler:b.bind(e._handleNewFileGeneric,e);!b.isInput(a)&&0<=a.size&&(g=a.size);k(a,h,f,g,c,d,this._options.request.uuidName,{uploadData:e._uploadData,paramsStore:e._paramsStore,addFileToHandler:function(a,b){e._handler.add(a,b);e._netUploadedOrQueued++;e._trackButton(a)}})},_handleNewFileGeneric:function(a,
b,c,e,f,g){b=this._uploadData.addFile({uuid:c,name:b,size:e,batchId:g});this._handler.add(b,a);this._trackButton(b);this._netUploadedOrQueued++;f.push({id:b,file:a})},_handlePasteSuccess:function(a,b){var c=a.type.split("/")[1],e=b;null==e&&(e=this._options.paste.defaultName);this.addFiles({name:e+("."+c),blob:a})},_initExtraButton:function(a){var b=this._createUploadButton({accept:a.validation.acceptFiles,allowedExtensions:a.validation.allowedExtensions,element:a.element,folders:a.folders,multiple:a.multiple,
title:a.fileInputTitle});this._extraButtonSpecs[b.getButtonId()]=a},_initFormSupportAndParams:function(){(this._formSupport=b.FormSupport&&new b.FormSupport(this._options.form,b.bind(this.uploadStoredFiles,this),b.bind(this.log,this)))&&this._formSupport.attachedToForm?(this._paramsStore=this._createStore(this._options.request.params,this._formSupport.getFormInputsAsObject),this._options.autoUpload=this._formSupport.newAutoUpload,this._formSupport.newEndpoint&&(this._options.request.endpoint=this._formSupport.newEndpoint)):
this._paramsStore=this._createStore(this._options.request.params)},_isDeletePossible:function(){return b.DeleteFileAjaxRequester&&this._options.deleteFile.enabled?this._options.cors.expected?b.supportedFeatures.deleteFileCorsXhr||b.supportedFeatures.deleteFileCorsXdr&&this._options.cors.allowXdr?!0:!1:!0:!1},_isAllowedExtension:function(a,d){var c=!1;if(!a.length)return!0;b.each(a,function(a,f){if(b.isString(f)&&null!=d.match(new RegExp("\\."+f+"$","i")))return c=!0,!1});return c},_itemError:function(a,
d,c){function e(a,b){f=f.replace(a,b)}var f=this._options.messages[a],g=[],h=[].concat(d);a=h[0];c=this._getButtonId(c);c=this._getValidationBase(c);b.each(c.allowedExtensions,function(a,c){b.isString(c)&&g.push(c)});d=g.join(", ").toLowerCase();e("{file}",this._options.formatFileName(a));e("{extensions}",d);e("{sizeLimit}",this._formatSize(c.sizeLimit));e("{minSizeLimit}",this._formatSize(c.minSizeLimit));c=f.match(/(\{\w+\})/g);null!==c&&b.each(c,function(a,b){e(b,h[a])});this._options.callbacks.onError(null,
a,f,void 0);return f},_manualRetry:function(a,d){if(this._onBeforeManualRetry(a))return this._netUploadedOrQueued++,this._uploadData.setStatus(a,b.status.UPLOAD_RETRYING),d?d(a):this._handler.retry(a),!0},_maybeAllComplete:function(a,d){var c=this,e=this._getNotFinished();d===b.status.UPLOAD_SUCCESSFUL?this._succeededSinceLastAllComplete.push(a):d===b.status.UPLOAD_FAILED&&this._failedSinceLastAllComplete.push(a);0===e&&(this._succeededSinceLastAllComplete.length||this._failedSinceLastAllComplete.length)&&
setTimeout(function(){c._onAllComplete(c._succeededSinceLastAllComplete,c._failedSinceLastAllComplete)},0)},_maybeHandleIos8SafariWorkaround:function(){var a=this;if(this._options.workarounds.ios8SafariUploads&&b.ios800()&&b.iosSafari())throw setTimeout(function(){window.alert(a._options.messages.unsupportedBrowserIos8Safari)},0),new b.Error(this._options.messages.unsupportedBrowserIos8Safari);},_maybeParseAndSendUploadError:function(a,b,c,e){if(!c.success)if(e&&200!==e.status&&!c.error)this._options.callbacks.onError(a,
b,"XHR returned response code "+e.status,e);else this._options.callbacks.onError(a,b,c.error?c.error:this._options.text.defaultResponseError,e)},_maybeProcessNextItemAfterOnValidateCallback:function(a,d,c,e,f){var g=this;if(d.length>c)if(a||!this._options.validation.stopOnFirstInvalidFile)setTimeout(function(){var a=g._getValidationDescriptor(d[c]),k=g._getButtonId(d[c].file),k=g._getButton(k);g._handleCheckedCallback({name:"onValidate",callback:b.bind(g._options.callbacks.onValidate,g,a,k),onSuccess:b.bind(g._onValidateCallbackSuccess,
g,d,c,e,f),onFailure:b.bind(g._onValidateCallbackFailure,g,d,c,e,f),identifier:"Item '"+a.name+"', size: "+a.size})},0);else if(!a)for(;c<d.length;c++)g._fileOrBlobRejected(d[c].id)},_onAllComplete:function(a,d){this._totalProgress&&this._totalProgress.onAllComplete(a,d,this._preventRetries);this._options.callbacks.onAllComplete(b.extend([],a),b.extend([],d));this._succeededSinceLastAllComplete=[];this._failedSinceLastAllComplete=[]},_onAutoRetry:function(a,d,c,e,f){var g=this;g._preventRetries[a]=
c[g._options.retry.preventRetryResponseProperty];if(g._shouldAutoRetry(a,d,c)){var h=1E3*g._options.retry.autoAttemptDelay;g._maybeParseAndSendUploadError.apply(g,arguments);g._options.callbacks.onAutoRetry(a,d,g._autoRetries[a]);g._onBeforeAutoRetry(a,d);g._uploadData.setStatus(a,b.status.UPLOAD_RETRYING);g._retryTimeouts[a]=setTimeout(function(){g.log("Starting retry for "+d+"...");f?f(a):g._handler.retry(a)},h);return!0}},_onBeforeAutoRetry:function(a,b){this.log("Waiting "+this._options.retry.autoAttemptDelay+
" seconds before retrying "+b+"...")},_onBeforeManualRetry:function(a){var b=this._currentItemLimit,c;if(this._preventRetries[a])return this.log("Retries are forbidden for id "+a,"warn"),!1;if(this._handler.isValid(a)){c=this.getName(a);if(!1===this._options.callbacks.onManualRetry(a,c))return!1;if(0<b&&this._netUploadedOrQueued+1>b)return this._itemError("retryFailTooManyItems"),!1;this.log("Retrying upload for '"+c+"' (id: "+a+")...");return!0}this.log("'"+a+"' is not a valid file ID","error");
return!1},_onCancel:function(a,d){this._netUploadedOrQueued--;clearTimeout(this._retryTimeouts[a]);var c=b.indexOf(this._storedIds,a);!this._options.autoUpload&&0<=c&&this._storedIds.splice(c,1);this._uploadData.setStatus(a,b.status.CANCELED)},_onComplete:function(a,d,c,e){c.success?(c.thumbnailUrl&&(this._thumbnailUrls[a]=c.thumbnailUrl),this._netUploaded++,this._uploadData.setStatus(a,b.status.UPLOAD_SUCCESSFUL)):(this._netUploadedOrQueued--,this._uploadData.setStatus(a,b.status.UPLOAD_FAILED),
!0===c[this._options.retry.preventRetryResponseProperty]&&(this._preventRetries[a]=!0));this._maybeParseAndSendUploadError(a,d,c,e);return c.success?!0:!1},_onDelete:function(a){this._uploadData.setStatus(a,b.status.DELETING)},_onDeleteComplete:function(a,d,c){var e=this.getName(a);if(c)if(this._uploadData.setStatus(a,b.status.DELETE_FAILED),this.log("Delete request for '"+e+"' has failed.","error"),void 0===d.withCredentials)this._options.callbacks.onError(a,e,"Delete request failed",d);else this._options.callbacks.onError(a,
e,"Delete request failed with response code "+d.status,d);else this._netUploadedOrQueued--,this._netUploaded--,this._handler.expunge(a),this._uploadData.setStatus(a,b.status.DELETED),this.log("Delete request for '"+e+"' has succeeded.")},_onInputChange:function(a){var d;if(b.supportedFeatures.ajaxUploading){for(d=0;d<a.files.length;d++)this._annotateWithButtonId(a.files[d],a);this.addFiles(a.files)}else 0<a.value.length&&this.addFiles(a);b.each(this._buttons,function(a,b){b.reset()})},_onProgress:function(a,
b,c,e){this._totalProgress&&this._totalProgress.onIndividualProgress(a,c,e)},_onSubmit:function(a,b){},_onSubmitCallbackSuccess:function(a,d){this._onSubmit.apply(this,arguments);this._uploadData.setStatus(a,b.status.SUBMITTED);this._onSubmitted.apply(this,arguments);this._options.autoUpload?(this._options.callbacks.onSubmitted.apply(this,arguments),this._uploadFile(a)):(this._storeForLater(a),this._options.callbacks.onSubmitted.apply(this,arguments))},_onSubmitDelete:function(a,d,c){var e=this.getUuid(a),
f;d&&(f=b.bind(d,this,a,e,c));if(this._isDeletePossible())return this._handleCheckedCallback({name:"onSubmitDelete",callback:b.bind(this._options.callbacks.onSubmitDelete,this,a),onSuccess:f||b.bind(this._deleteHandler.sendDelete,this,a,e,c),identifier:a}),!0;this.log("Delete request ignored for ID "+a+", delete feature is disabled or request not possible due to CORS on a user agent that does not support pre-flighting.","warn");return!1},_onSubmitted:function(a){},_onTotalProgress:function(a,b){this._options.callbacks.onTotalProgress(a,
b)},_onUploadPrep:function(a){},_onUpload:function(a,d){this._uploadData.setStatus(a,b.status.UPLOADING)},_onUploadChunk:function(a,b){},_onUploadStatusChange:function(a,d,c){c===b.status.PAUSED&&clearTimeout(this._retryTimeouts[a])},_onValidateBatchCallbackFailure:function(a){var d=this;b.each(a,function(a,b){d._fileOrBlobRejected(b.id)})},_onValidateBatchCallbackSuccess:function(a,d,c,e,f){var g=this._currentItemLimit,h=this._netUploadedOrQueued;0===g||h<=g?0<d.length?this._handleCheckedCallback({name:"onValidate",
callback:b.bind(this._options.callbacks.onValidate,this,a[0],f),onSuccess:b.bind(this._onValidateCallbackSuccess,this,d,0,c,e),onFailure:b.bind(this._onValidateCallbackFailure,this,d,0,c,e),identifier:"Item '"+d[0].file.name+"', size: "+d[0].file.size}):this._itemError("noFilesError"):(this._onValidateBatchCallbackFailure(d),a=this._options.messages.tooManyItemsError.replace(/\{netItems\}/g,h).replace(/\{itemLimit\}/g,g),this._batchError(a))},_onValidateCallbackFailure:function(a,b,c,e){var f=b+1;
this._fileOrBlobRejected(a[b].id,a[b].file.name);this._maybeProcessNextItemAfterOnValidateCallback(!1,a,f,c,e)},_onValidateCallbackSuccess:function(a,b,c,e){var f=this,g=b+1,h=this._getValidationDescriptor(a[b]);this._validateFileOrBlobData(a[b],h).then(function(){f._upload(a[b].id,c,e);f._maybeProcessNextItemAfterOnValidateCallback(!0,a,g,c,e)},function(){f._maybeProcessNextItemAfterOnValidateCallback(!1,a,g,c,e)})},_prepareItemsForUpload:function(a,d,c){if(0===a.length)this._itemError("noFilesError");
else{var e=this._getValidationDescriptors(a),f=this._getButtonId(a[0].file),f=this._getButton(f);this._handleCheckedCallback({name:"onValidateBatch",callback:b.bind(this._options.callbacks.onValidateBatch,this,e,f),onSuccess:b.bind(this._onValidateBatchCallbackSuccess,this,e,a,d,c,f),onFailure:b.bind(this._onValidateBatchCallbackFailure,this,a),identifier:"batch validation"})}},_preventLeaveInProgress:function(){var a=this;this._disposeSupport.attach(window,"beforeunload",function(b){if(a.getInProgress())return b=
b||window.event,b.returnValue=a._options.messages.onLeave})},_refreshSessionData:function(){var a=this,d=this._options.session;b.Session&&null!=this._options.session.endpoint&&(this._session||(b.extend(d,{cors:this._options.cors}),d.log=b.bind(this.log,this),d.addFileRecord=b.bind(this._addCannedFile,this),this._session=new b.Session(d)),setTimeout(function(){a._session.refresh().then(function(b,d){a._sessionRequestComplete();a._options.callbacks.onSessionRequestComplete(b,!0,d)},function(b,d){a._options.callbacks.onSessionRequestComplete(b,
!1,d)})},0))},_sessionRequestComplete:function(){},_setSize:function(a,b){this._uploadData.updateSize(a,b);this._totalProgress&&this._totalProgress.onNewSize(a)},_shouldAutoRetry:function(a,d,c){d=this._uploadData.retrieve({id:a});return!this._preventRetries[a]&&this._options.retry.enableAuto&&d.status!==b.status.PAUSED&&(void 0===this._autoRetries[a]&&(this._autoRetries[a]=0),this._autoRetries[a]<this._options.retry.maxAutoAttempts)?(this._autoRetries[a]+=1,!0):!1},_storeForLater:function(a){this._storedIds.push(a)},
_trackButton:function(a){var d;(d=b.supportedFeatures.ajaxUploading?this._handler.getFile(a).qqButtonId:this._getButtonId(this._handler.getInput(a)))&&(this._buttonIdsForFileIds[a]=d)},_updateFormSupportAndParams:function(a){this._options.form.element=a;(this._formSupport=b.FormSupport&&new b.FormSupport(this._options.form,b.bind(this.uploadStoredFiles,this),b.bind(this.log,this)))&&this._formSupport.attachedToForm&&(this._paramsStore.addReadOnly(null,this._formSupport.getFormInputsAsObject),this._options.autoUpload=
this._formSupport.newAutoUpload,this._formSupport.newEndpoint&&this.setEndpoint(this._formSupport.newEndpoint))},_upload:function(a,d,c){var e=this.getName(a);d&&this.setParams(d,a);c&&this.setEndpoint(c,a);this._handleCheckedCallback({name:"onSubmit",callback:b.bind(this._options.callbacks.onSubmit,this,a,e),onSuccess:b.bind(this._onSubmitCallbackSuccess,this,a,e),onFailure:b.bind(this._fileOrBlobRejected,this,a,e),identifier:a})},_uploadFile:function(a){this._handler.upload(a)||this._uploadData.setStatus(a,
b.status.QUEUED)},_uploadStoredFiles:function(){for(var a,d=this;this._storedIds.length;)a=this._storedIds.shift(),this._uploadFile(a);if(a=this.getUploads({status:b.status.SUBMITTING}).length)b.log("Still waiting for "+a+" files to clear submit queue. Will re-parse stored IDs array shortly."),setTimeout(function(){d._uploadStoredFiles()},1E3)},_validateFileOrBlobData:function(a,d){var c=this,e;e=a.file instanceof b.BlobProxy?a.file.referenceBlob:a.file;var f=d.name,g=d.size,h=this._getButtonId(a.file),
h=this._getValidationBase(h),k=new b.Promise;k.then(function(){},function(){c._fileOrBlobRejected(a.id,f)});if(b.isFileOrInput(e)&&!this._isAllowedExtension(h.allowedExtensions,f))return this._itemError("typeError",f,e),k.failure();if(0===g)return this._itemError("emptyError",f,e),k.failure();if(0<g&&h.sizeLimit&&g>h.sizeLimit)return this._itemError("sizeError",f,e),k.failure();if(0<g&&g<h.minSizeLimit)return this._itemError("minSizeError",f,e),k.failure();b.ImageValidation&&b.supportedFeatures.imagePreviews&&
b.isFile(e)?(new b.ImageValidation(e,b.bind(c.log,c))).validate(h.image).then(k.success,function(a){c._itemError(a+"ImageError",f,e);k.failure()}):k.success();return k},_wrapCallbacks:function(){var a,b,c;a=this;b=function(b,c,d){try{return c.apply(a,d)}catch(h){c=h.message||h.toString(),a.log("Caught exception in '"+b+"' callback - "+c,"error")}};for(c in this._options.callbacks)(function(){var e,f;e=c;f=a._options.callbacks[e];a._options.callbacks[e]=function(){return b(e,f,arguments)}})()}}})();
(function(){b.FineUploaderBasic=function(a){var d=this;this._options={debug:!1,button:null,multiple:!0,maxConnections:3,disableCancelForFormUploads:!1,autoUpload:!0,request:{customHeaders:{},endpoint:"/server/upload",filenameParam:"qqfilename",forceMultipart:!0,inputName:"qqfile",method:"POST",params:{},paramsInBody:!0,totalFileSizeName:"qqtotalfilesize",uuidName:"qquuid"},validation:{allowedExtensions:[],sizeLimit:0,minSizeLimit:0,itemLimit:0,stopOnFirstInvalidFile:!0,acceptFiles:null,image:{maxHeight:0,
maxWidth:0,minHeight:0,minWidth:0}},callbacks:{onSubmit:function(a,b){},onSubmitted:function(a,b){},onComplete:function(a,b,d,g){},onAllComplete:function(a,b){},onCancel:function(a,b){},onUpload:function(a,b){},onUploadChunk:function(a,b,d){},onUploadChunkSuccess:function(a,b,d,g){},onResume:function(a,b,d){},onProgress:function(a,b,d,g){},onTotalProgress:function(a,b){},onError:function(a,b,d,g){},onAutoRetry:function(a,b,d){},onManualRetry:function(a,b){},onValidateBatch:function(a){},onValidate:function(a){},
onSubmitDelete:function(a){},onDelete:function(a){},onDeleteComplete:function(a,b,d){},onPasteReceived:function(a){},onStatusChange:function(a,b,d){},onSessionRequestComplete:function(a,b,d){}},messages:{typeError:"{file} has an invalid extension. Valid extension(s): {extensions}.",sizeError:"{file} is too large, maximum file size is {sizeLimit}.",minSizeError:"{file} is too small, minimum file size is {minSizeLimit}.",emptyError:"{file} is empty, please select files again without it.",noFilesError:"No files to upload.",
tooManyItemsError:"Too many items ({netItems}) would be uploaded.  Item limit is {itemLimit}.",maxHeightImageError:"Image is too tall.",maxWidthImageError:"Image is too wide.",minHeightImageError:"Image is not tall enough.",minWidthImageError:"Image is not wide enough.",retryFailTooManyItems:"Retry failed - you have reached your file limit.",onLeave:"The files are being uploaded, if you leave now the upload will be canceled.",unsupportedBrowserIos8Safari:"Unrecoverable error - this browser does not permit file uploading of any kind due to serious bugs in iOS8 Safari.  Please use iOS8 Chrome until Apple fixes these issues."},
retry:{enableAuto:!1,maxAutoAttempts:3,autoAttemptDelay:5,preventRetryResponseProperty:"preventRetry"},classes:{buttonHover:"qq-upload-button-hover",buttonFocus:"qq-upload-button-focus"},chunking:{enabled:!1,concurrent:{enabled:!1},mandatory:!1,paramNames:{partIndex:"qqpartindex",partByteOffset:"qqpartbyteoffset",chunkSize:"qqchunksize",totalFileSize:"qqtotalfilesize",totalParts:"qqtotalparts"},partSize:2E6,success:{endpoint:null}},resume:{enabled:!1,recordsExpireIn:7,paramNames:{resuming:"qqresume"}},
formatFileName:function(a){return a},text:{defaultResponseError:"Upload failure reason unknown",fileInputTitle:"file input",sizeSymbols:"kB MB GB TB PB EB".split(" ")},deleteFile:{enabled:!1,method:"DELETE",endpoint:"/server/upload",customHeaders:{},params:{}},cors:{expected:!1,sendCredentials:!1,allowXdr:!1},blobs:{defaultName:"misc_data"},paste:{targetElement:null,defaultName:"pasted_image"},camera:{ios:!1,button:null},extraButtons:[],session:{endpoint:null,params:{},customHeaders:{},refreshOnReset:!0},
form:{element:"qq-form",autoUpload:!1,interceptSubmit:!0},scaling:{customResizer:null,sendOriginal:!0,orient:!0,defaultType:null,defaultQuality:80,failureText:"Failed to scale",includeExif:!1,sizes:[]},workarounds:{iosEmptyVideos:!0,ios8SafariUploads:!0,ios8BrowserCrash:!1}};b.extend(this._options,a,!0);this._buttons=[];this._extraButtonSpecs={};this._buttonIdsForFileIds=[];this._wrapCallbacks();this._disposeSupport=new b.DisposeSupport;this._storedIds=[];this._autoRetries=[];this._retryTimeouts=
[];this._preventRetries=[];this._thumbnailUrls=[];this._netUploaded=this._netUploadedOrQueued=0;this._uploadData=this._createUploadDataTracker();this._initFormSupportAndParams();this._customHeadersStore=this._createStore(this._options.request.customHeaders);this._deleteFileCustomHeadersStore=this._createStore(this._options.deleteFile.customHeaders);this._deleteFileParamsStore=this._createStore(this._options.deleteFile.params);this._endpointStore=this._createStore(this._options.request.endpoint);this._deleteFileEndpointStore=
this._createStore(this._options.deleteFile.endpoint);this._handler=this._createUploadHandler();this._deleteHandler=b.DeleteFileAjaxRequester&&this._createDeleteHandler();this._options.button&&(this._defaultButtonId=this._createUploadButton({element:this._options.button,title:this._options.text.fileInputTitle}).getButtonId());this._generateExtraButtonSpecs();this._handleCameraAccess();this._options.paste.targetElement&&(b.PasteSupport?this._pasteHandler=this._createPasteHandler():this.log("Paste support module not found",
"error"));this._preventLeaveInProgress();this._imageGenerator=b.ImageGenerator&&new b.ImageGenerator(b.bind(this.log,this));this._refreshSessionData();this._succeededSinceLastAllComplete=[];this._failedSinceLastAllComplete=[];this._scaler=b.Scaler&&new b.Scaler(this._options.scaling,b.bind(this.log,this))||{};this._scaler.enabled&&(this._customNewFileHandler=b.bind(this._scaler.handleNewFile,this._scaler));b.TotalProgress&&b.supportedFeatures.progressBar&&(this._totalProgress=new b.TotalProgress(b.bind(this._onTotalProgress,
this),function(a){return(a=d._uploadData.retrieve({id:a}))&&a.size||0}));this._currentItemLimit=this._options.validation.itemLimit};b.FineUploaderBasic.prototype=b.basePublicApi;b.extend(b.FineUploaderBasic.prototype,b.basePrivateApi)})();b.AjaxRequester=function(a){function d(a){var c=!1;b.each(c,function(a,d){if(0>b.indexOf(["Accept","Accept-Language","Content-Language","Content-Type"],d))return c=!0,!1});return c}function c(a){return r.cors.expected&&void 0===a.withCredentials}function e(){var a;
if(window.XMLHttpRequest||window.ActiveXObject)a=b.createXhrInstance(),void 0===a.withCredentials&&(a=new XDomainRequest,a.onload=function(){},a.onerror=function(){},a.ontimeout=function(){},a.onprogress=function(){});return a}function f(a,c){var d=x[a].xhr;d||(d=c?c:r.cors.expected?e():b.createXhrInstance(),x[a].xhr=d);return d}function g(a){var c=b.indexOf(v,a),d=r.maxConnections;delete x[a];v.splice(c,1);v.length>=d&&c<d&&(a=v[d-1],l(a))}function h(a,d){var e=f(a),t=r.method,x=!0===d;g(a);x?w(t+
" request for "+a+" has failed","error"):c(e)||0<=b.indexOf(r.successfulResponseCodes[r.method],e.status)||(x=!0,w(t+" request for "+a+" has failed - response code "+e.status,"error"));r.onComplete(a,e,x)}function k(a){var c=x[a].additionalParams,d=r.mandatedParams,f;r.paramsStore.get&&(f=r.paramsStore.get(a));c&&b.each(c,function(a,b){f=f||{};f[a]=b});d&&b.each(d,function(a,b){f=f||{};f[a]=b});return f}function l(a,d){var e=f(a,d),g=r.method,h=k(a),v=x[a].payload,l;r.onSend(a);l=x[a].additionalQueryParams;
var z=r.endpointStore.get(a),C=x[a].addToPath;void 0!=C&&(z+="/"+C);u&&h&&(z=b.obj2url(h,z));l&&(z=b.obj2url(l,z));l=z;c(e)?(e.onload=q(a),e.onerror=p(a)):e.onreadystatechange=n(a);m(a);e.open(g,l,!0);r.cors.expected&&r.cors.sendCredentials&&!c(e)&&(e.withCredentials=!0);t(a);w("Sending "+g+" request for "+a);v?e.send(v):u||!h?e.send():h&&r.contentType&&0<=r.contentType.toLowerCase().indexOf("application/x-www-form-urlencoded")?e.send(b.obj2url(h,"")):h&&r.contentType&&0<=r.contentType.toLowerCase().indexOf("application/json")?
e.send(JSON.stringify(h)):e.send(h);return e}function n(a){return function(){4===f(a).readyState&&h(a)}}function m(a){var b=r.onProgress;b&&(f(a).upload.onprogress=function(c){c.lengthComputable&&b(a,c.loaded,c.total)})}function q(a){return function(){h(a)}}function p(a){return function(){h(a,!0)}}function t(a){var e=f(a),t=r.customHeaders,g=x[a].additionalHeaders||{},h=r.method,k={};c(e)||(r.acceptHeader&&e.setRequestHeader("Accept",r.acceptHeader),!r.allowXRequestedWithAndCacheControl||r.cors.expected&&
0<=b.indexOf(["GET","POST","HEAD"],r.method)&&!d(t)||(e.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.setRequestHeader("Cache-Control","no-cache")),!r.contentType||"POST"!==h&&"PUT"!==h||e.setRequestHeader("Content-Type",r.contentType),b.extend(k,b.isFunction(t)?t(a):t),b.extend(k,g),b.each(k,function(a,b){e.setRequestHeader(a,b)}))}var w,u,v=[],x={},r={acceptHeader:null,validMethods:["PATCH","POST","PUT"],method:"POST",contentType:"application/x-www-form-urlencoded",maxConnections:3,customHeaders:{},
endpointStore:{},paramsStore:{},mandatedParams:{},allowXRequestedWithAndCacheControl:!0,successfulResponseCodes:{DELETE:[200,202,204],PATCH:[200,201,202,203,204],POST:[200,201,202,203,204],PUT:[200,201,202,203,204],GET:[200]},cors:{expected:!1,sendCredentials:!1},log:function(a,b){},onSend:function(a){},onComplete:function(a,b,c){},onProgress:null};b.extend(r,a);w=r.log;if(0>b.indexOf(r.validMethods,r.method))throw Error("'"+r.method+"' is not a supported method for this type of request!");u="GET"===
r.method||"DELETE"===r.method;b.extend(this,{initTransport:function(a){var c,d,e,f,t,g;return{withPath:function(a){c=a;return this},withParams:function(a){d=a;return this},withQueryParams:function(a){g=a;return this},withHeaders:function(a){e=a;return this},withPayload:function(a){f=a;return this},withCacheBuster:function(){t=!0;return this},send:function(h){t&&0<=b.indexOf(["GET","DELETE"],r.method)&&(d.qqtimestamp=(new Date).getTime());x[a]={addToPath:c,additionalParams:d,additionalQueryParams:g,
additionalHeaders:e,payload:f};h=v.push(a)<=r.maxConnections?l(a,h):void 0;return h}}},canceled:function(a){g(a)}})};b.UploadHandler=function(a){a=a.proxy;var d={},c=a.onCancel,e=a.getName;b.extend(this,{add:function(a,b){d[a]=b;d[a].temp={}},cancel:function(a){var g=this,h=new b.Promise;c(a,e(a),h).then(function(){g.isValid(a)&&(d[a].canceled=!0,g.expunge(a));h.success()})},expunge:function(a){delete d[a]},getThirdPartyFileId:function(a){return d[a].key},isValid:function(a){return void 0!==d[a]},
reset:function(){d={}},_getFileState:function(a){return d[a]},_setThirdPartyFileId:function(a,b){d[a].key=b},_wasCanceled:function(a){return!!d[a].canceled}})};b.UploadHandlerController=function(a,d){var c=this,e=!1,f=!1,g,h,k,l={paramsStore:{},maxConnections:3,chunking:{enabled:!1,multiple:{enabled:!1}},log:function(a,b){},onProgress:function(a,b,c,d){},onComplete:function(a,b,c,d){},onCancel:function(a,b){},onUploadPrep:function(a){},onUpload:function(a,b){},onUploadChunk:function(a,b,c){},onUploadChunkSuccess:function(a,
b,c,d){},onAutoRetry:function(a,b,c,d){},onResume:function(a,b,c){},onUuidChanged:function(a,b){},getName:function(a){},setSize:function(a,b){},isQueued:function(a){},getIdsInProxyGroup:function(a){},getIdsInBatch:function(a){}},n={done:function(a,b,c,d){var e=k._getChunkData(a,b);k._getFileState(a).attemptingResume=!1;delete k._getFileState(a).temp.chunkProgress[b];k._getFileState(a).loaded+=e.size;l.onUploadChunkSuccess(a,k._getChunkDataForCallback(e),c,d)},finalize:function(a){var b=l.getSize(a),
c=l.getName(a);h("All chunks have been uploaded for "+a+" - finalizing....");k.finalizeChunks(a).then(function(d,e){h("Finalize successful for "+a);var f=p.normalizeResponse(d,!0);l.onProgress(a,c,b,b);k._maybeDeletePersistedChunkData(a);p.cleanup(a,f,e)},function(b,d){var e=p.normalizeResponse(b,!1);h("Problem finalizing chunks for file ID "+a+" - "+e.error,"error");e.reset&&n.reset(a);l.onAutoRetry(a,c,e,d)||p.cleanup(a,e,d)})},handleFailure:function(a,c,d,e){var g=l.getName(c);h("Chunked upload request failed for "+
c+", chunk "+a);k.clearCachedChunk(c,a);d=p.normalizeResponse(d,!1);var r;d.reset?n.reset(c):(r=b.indexOf(k._getFileState(c).chunking.inProgress,a),0<=r&&(k._getFileState(c).chunking.inProgress.splice(r,1),k._getFileState(c).chunking.remaining.unshift(a)));k._getFileState(c).temp.ignoreFailure||(f&&(k._getFileState(c).temp.ignoreFailure=!0,h(b.format("Going to attempt to abort these chunks: {}. These are currently in-progress: {}.",JSON.stringify(Object.keys(k._getXhrs(c))),JSON.stringify(k._getFileState(c).chunking.inProgress))),
b.each(k._getXhrs(c),function(a,d){h(b.format("Attempting to abort file {}.{}. XHR readyState {}. ",c,a,d.readyState));d.abort();d._cancelled=!0}),k.moveInProgressToRemaining(c),m.free(c,!0)),l.onAutoRetry(c,g,d,e)||p.cleanup(c,d,e))},hasMoreParts:function(a){return!!k._getFileState(a).chunking.remaining.length},nextPart:function(a){var b=k._getFileState(a).chunking.remaining.shift();b>=k._getTotalChunks(a)&&(b=null);return b},reset:function(a){h("Server or callback has ordered chunking effort to be restarted on next attempt for item ID "+
a,"error");k._maybeDeletePersistedChunkData(a);k.reevaluateChunking(a);k._getFileState(a).loaded=0},sendNext:function(a){var c=l.getSize(a),d=l.getName(a),e=n.nextPart(a),g=k._getChunkData(a,e),r=k._getFileState(a).attemptingResume,q=k._getFileState(a).chunking.inProgress||[];null==k._getFileState(a).loaded&&(k._getFileState(a).loaded=0);r&&!1===l.onResume(a,d,g)&&(n.reset(a),e=n.nextPart(a),g=k._getChunkData(a,e),r=!1);null==e&&0===q.length?n.finalize(a):(h(b.format("Sending chunked upload request for item {}.{}, bytes {}-{} of {}.",
a,e,g.start+1,g.end,c)),l.onUploadChunk(a,d,k._getChunkDataForCallback(g)),q.push(e),k._getFileState(a).chunking.inProgress=q,f&&m.open(a,e),f&&m.available()&&k._getFileState(a).chunking.remaining.length&&n.sendNext(a),0===g.blob.size?(h(b.format("Chunk {} for file {} will not be uploaded, zero sized chunk.",e,a),"error"),n.handleFailure(e,a,"File is no longer available",null)):k.uploadChunk(a,e,r).then(function(c,d){h("Chunked upload request succeeded for "+a+", chunk "+e);k.clearCachedChunk(a,e);
var f=k._getFileState(a).chunking.inProgress||[],g=p.normalizeResponse(c,!0),x=b.indexOf(f,e);h(b.format("Chunk {} for file {} uploaded successfully.",e,a));n.done(a,e,g,d);0<=x&&f.splice(x,1);k._maybePersistChunkedState(a);n.hasMoreParts(a)||0!==f.length?n.hasMoreParts(a)?n.sendNext(a):h(b.format("File ID {} has no more chunks to send and these chunk indexes are still marked as in-progress: {}",a,JSON.stringify(f))):n.finalize(a)},function(b,c){n.handleFailure(e,a,b,c)}).done(function(){k.clearXhr(a,
e)}))}},m={_open:[],_openChunks:{},_waiting:[],available:function(){var a=l.maxConnections,c=0,d=0;b.each(m._openChunks,function(a,b){c++;d+=b.length});return a-(m._open.length-c+d)},free:function(a,c){var d=!c,e=b.indexOf(m._waiting,a),f=b.indexOf(m._open,a);delete m._openChunks[a];p.getProxyOrBlob(a)instanceof b.BlobProxy&&(h("Generated blob upload has ended for "+a+", disposing generated blob."),delete k._getFileState(a).file);0<=e?m._waiting.splice(e,1):d&&0<=f&&(m._open.splice(f,1),d=m._waiting.shift(),
0<=d&&(m._open.push(d),p.start(d)))},getWaitingOrConnected:function(){var a=[];b.each(m._openChunks,function(b,c){c&&c.length&&a.push(parseInt(b))});b.each(m._open,function(b,c){m._openChunks[c]||a.push(parseInt(c))});return a=a.concat(m._waiting)},isUsingConnection:function(a){return 0<=b.indexOf(m._open,a)},open:function(a,b){null==b&&m._waiting.push(a);if(m.available()){if(null==b)m._waiting.pop(),m._open.push(a);else{var c=m._openChunks[a]||[];c.push(b);m._openChunks[a]=c}return!0}return!1},reset:function(){m._waiting=
[];m._open=[]}},q={send:function(a,b){k._getFileState(a).loaded=0;h("Sending simple upload request for "+a);k.uploadFile(a).then(function(c,d){h("Simple upload request succeeded for "+a);var e=p.normalizeResponse(c,!0),f=l.getSize(a);l.onProgress(a,b,f,f);p.maybeNewUuid(a,e);p.cleanup(a,e,d)},function(c,d){h("Simple upload request failed for "+a);var e=p.normalizeResponse(c,!1);l.onAutoRetry(a,b,e,d)||p.cleanup(a,e,d)})}},p={cancel:function(a){h("Cancelling "+a);l.paramsStore.remove(a);m.free(a)},
cleanup:function(a,b,c){var d=l.getName(a);l.onComplete(a,d,b,c);k._getFileState(a)&&k._clearXhrs&&k._clearXhrs(a);m.free(a)},getProxyOrBlob:function(a){return k.getProxy&&k.getProxy(a)||k.getFile&&k.getFile(a)},initHandler:function(){k=new (d?b[d]:b.traditional)[(b.supportedFeatures.ajaxUploading?"Xhr":"Form")+"UploadHandler"](l,{getDataByUuid:l.getDataByUuid,getName:l.getName,getSize:l.getSize,getUuid:l.getUuid,log:h,onCancel:l.onCancel,onProgress:l.onProgress,onUuidChanged:l.onUuidChanged});k._removeExpiredChunkingRecords&&
k._removeExpiredChunkingRecords()},isDeferredEligibleForUpload:function(a){return l.isQueued(a)},maybeDefer:function(a,c){if(c&&!k.getFile(a)&&c instanceof b.BlobProxy)l.onUploadPrep(a),h("Attempting to generate a blob on-demand for "+a),c.create().then(function(b){h("Generated an on-demand blob for "+a);k.updateBlob(a,b);l.setSize(a,b.size);k.reevaluateChunking(a);p.maybeSendDeferredFiles(a)},function(c){var d={};c&&(d.error=c);h(b.format("Failed to generate blob for ID {}.  Error message: {}.",
a,c),"error");l.onComplete(a,l.getName(a),b.extend(d,g),null);p.maybeSendDeferredFiles(a);m.free(a)});else return p.maybeSendDeferredFiles(a);return!1},maybeSendDeferredFiles:function(a){var c=l.getIdsInProxyGroup(a),d=!1;c&&c.length?(h("Maybe ready to upload proxy group file "+a),b.each(c,function(b,c){if(p.isDeferredEligibleForUpload(c)&&k.getFile(c))d=c===a,p.now(c);else if(p.isDeferredEligibleForUpload(c))return!1})):(d=!0,p.now(a));return d},maybeNewUuid:function(a,b){if(void 0!==b.newUuid)l.onUuidChanged(a,
b.newUuid)},normalizeResponse:function(a,c){var d=a;b.isObject(a)||(d={},b.isString(a)&&!c&&(d.error=a));d.success=c;return d},now:function(a){var d=l.getName(a);if(!c.isValid(a))throw new b.Error(a+" is not a valid file ID to upload!");l.onUpload(a,d);e&&k._shouldChunkThisFile(a)?n.sendNext(a):q.send(a,d)},start:function(a){var b=p.getProxyOrBlob(a);if(b)return p.maybeDefer(a,b);p.now(a);return!0}};b.extend(this,{add:function(a,b){k.add.apply(this,arguments)},upload:function(a){return m.open(a)?
p.start(a):!1},retry:function(a){f&&(k._getFileState(a).temp.ignoreFailure=!1);return m.isUsingConnection(a)?p.start(a):c.upload(a)},cancel:function(a){var c=k.cancel(a);b.isGenericPromise(c)?c.then(function(){p.cancel(a)}):!1!==c&&p.cancel(a)},cancelAll:function(){var a=m.getWaitingOrConnected(),b;if(a.length)for(b=a.length-1;0<=b;b--)c.cancel(a[b]);m.reset()},getFile:function(a){return k.getProxy&&k.getProxy(a)?k.getProxy(a).referenceBlob:k.getFile&&k.getFile(a)},isProxied:function(a){return!(!k.getProxy||
!k.getProxy(a))},getInput:function(a){if(k.getInput)return k.getInput(a)},reset:function(){h("Resetting upload handler");c.cancelAll();m.reset();k.reset()},expunge:function(a){if(c.isValid(a))return k.expunge(a)},isValid:function(a){return k.isValid(a)},getResumableFilesData:function(){return k.getResumableFilesData?k.getResumableFilesData():[]},getThirdPartyFileId:function(a){if(c.isValid(a))return k.getThirdPartyFileId(a)},pause:function(a){return c.isResumable(a)&&k.pause&&c.isValid(a)&&k.pause(a)?
(m.free(a),k.moveInProgressToRemaining(a),!0):!1},isResumable:function(a){return!!k.isResumable&&k.isResumable(a)}});b.extend(l,a);h=l.log;f=(e=l.chunking.enabled&&b.supportedFeatures.chunking)&&l.chunking.concurrent.enabled;g=function(){var a={};a[l.preventRetryParam]=!0;return a}();p.initHandler()};b.WindowReceiveMessage=function(a){var d={};b.extend({log:function(a,b){}},a);b.extend(this,{receiveMessage:function(a,e){var f=function(a){e(a.data)};window.postMessage?d[a]=b(window).attach("message",
f):log("iframe message passing not supported in this browser!","error")},stopReceivingMessages:function(a){window.postMessage&&(a=d[a])&&a()}})};b.FormUploadHandler=function(a){function d(a,c){var d=a.id,f=d.split("_")[0],g=q(f);h[g]=c;k[f]=b(a).attach("load",function(){e.getInput(f)&&(p("Received iframe load event for CORS upload request (iframe name "+d+")"),l[d]=setTimeout(function(){var a="No valid message received from loaded iframe for iframe name "+d;p(a,"error");c({error:a})},1E3))});t.receiveMessage(d,
function(a){p("Received the following window message: '"+a+"'");d.split("_");var b=e._parseJsonResponse(a),c=b.uuid;c&&h[c]?(p("Handling response for iframe name "+d),clearTimeout(l[d]),delete l[d],e._detachLoadEvent(d),a=h[c],delete h[c],t.stopReceivingMessages(d),a(b)):c||p("'"+a+"' does not contain a UUID - ignoring.")})}var c=a.options,e=this,f=a.proxy,g=b.getUniqueId(),h={},k={},l={},n=c.isCors,m=c.inputName,q=f.getUuid,p=f.log,t=new b.WindowReceiveMessage({log:p});b.extend(this,new b.UploadHandler(a));
b.override(this,function(a){return{add:function(c,d){a.add(c,{input:d});d.setAttribute("name",m);d.parentNode&&b(d).remove()},expunge:function(c){delete k[c];n&&(clearTimeout(l[c]),delete l[c],t.stopReceivingMessages(c));var d=document.getElementById(e._getIframeName(c));d&&(d.setAttribute("src","javascript:false;"),b(d).remove());a.expunge(c)},isValid:function(b){return a.isValid(b)&&void 0!==e._getFileState(b).input}}});b.extend(this,{getInput:function(a){return e._getFileState(a).input},_attachLoadEvent:function(a,
c){var e;n?d(a,c):k[a.id]=b(a).attach("load",function(){p("Received response for "+a.id);if(a.parentNode){try{if(a.contentDocument&&a.contentDocument.body&&"false"==a.contentDocument.body.innerHTML)return}catch(b){p("Error when attempting to access iframe during handling of upload response ("+b.message+")","error"),e={success:!1}}c(e)}})},_createIframe:function(a){a=e._getIframeName(a);var c=b.toElement("<iframe src='javascript:false;' name='"+a+"' />");c.setAttribute("id",a);c.style.display="none";
document.body.appendChild(c);return c},_detachLoadEvent:function(a){void 0!==k[a]&&(k[a](),delete k[a])},_getIframeName:function(a){return a+"_"+g},_initFormForUpload:function(a){var c=a.endpoint,d=a.params,e=a.paramsInBody,f=a.targetName;a=b.toElement("<form method='"+a.method+"' enctype='multipart/form-data'></form>");var g=c;e?b.obj2Inputs(d,a):g=b.obj2url(d,c);a.setAttribute("action",g);a.setAttribute("target",f);a.style.display="none";document.body.appendChild(a);return a},_parseJsonResponse:function(a){var c=
{};try{c=b.parseJson(a)}catch(d){p("Error when attempting to parse iframe upload response ("+d.message+")","error")}return c}})};b.XhrUploadHandler=function(a){function d(a){b.each(c._getXhrs(a),function(b,d){var e=c._getAjaxRequester(a,b);d.onreadystatechange=null;d.upload.onprogress=null;d.abort();e&&e.canceled&&e.canceled(a)})}var c=this,e=a.options.namespace,f=a.proxy,g=a.options.chunking,h=a.options.resume,k=g&&a.options.chunking.enabled&&b.supportedFeatures.chunking,l=h&&a.options.resume.enabled&&
k&&b.supportedFeatures.resume,n=f.getName,m=f.getSize,q=f.getUuid,p=f.getEndpoint,t=f.getDataByUuid,w=f.onUuidChanged,u=f.onProgress,v=f.log;b.extend(this,new b.UploadHandler(a));b.override(this,function(a){return{add:function(d,e){if(b.isFile(e)||b.isBlob(e))a.add(d,{file:e});else if(e instanceof b.BlobProxy)a.add(d,{proxy:e});else throw Error("Passed obj is not a File, Blob, or proxy");c._initTempState(d);l&&c._maybePrepareForResume(d)},expunge:function(b){d(b);c._maybeDeletePersistedChunkData(b);
c._clearXhrs(b);a.expunge(b)}}});b.extend(this,{clearCachedChunk:function(a,b){delete c._getFileState(a).temp.cachedChunks[b]},clearXhr:function(a,b){var d=c._getFileState(a).temp;d.xhrs&&delete d.xhrs[b];d.ajaxRequesters&&delete d.ajaxRequesters[b]},finalizeChunks:function(a,d){var e=c._getTotalChunks(a)-1,e=c._getXhr(a,e);return d?(new b.Promise).success(d(e),e):(new b.Promise).success({},e)},getFile:function(a){return c.isValid(a)&&c._getFileState(a).file},getProxy:function(a){return c.isValid(a)&&
c._getFileState(a).proxy},getResumableFilesData:function(){var a=[];c._iterateResumeRecords(function(b,d){c.moveInProgressToRemaining(null,d.chunking.inProgress,d.chunking.remaining);var e={name:d.name,remaining:d.chunking.remaining,size:d.size,uuid:d.uuid};d.key&&(e.key=d.key);a.push(e)});return a},isResumable:function(a){return!!g&&c.isValid(a)&&!c._getFileState(a).notResumable},moveInProgressToRemaining:function(a,d,e){d=d||c._getFileState(a).chunking.inProgress;var f=e||c._getFileState(a).chunking.remaining;
d&&(v(b.format("Moving these chunks from in-progress {}, to remaining.",JSON.stringify(d))),d.reverse(),b.each(d,function(a,b){f.unshift(b)}),d.length=0)},pause:function(a){if(c.isValid(a))return v(b.format("Aborting XHR upload for {} '{}' due to pause instruction.",a,n(a))),c._getFileState(a).paused=!0,d(a),!0},reevaluateChunking:function(a){if(g&&c.isValid(a)){var b=c._getFileState(a),d,e;delete b.chunking;b.chunking={};d=c._getTotalChunks(a);if(1<d||g.mandatory){b.chunking.enabled=!0;b.chunking.parts=
d;b.chunking.remaining=[];for(e=0;e<d;e++)b.chunking.remaining.push(e);c._initTempState(a)}else b.chunking.enabled=!1}},updateBlob:function(a,b){c.isValid(a)&&(c._getFileState(a).file=b)},_clearXhrs:function(a){var d=c._getFileState(a).temp;b.each(d.ajaxRequesters,function(a){delete d.ajaxRequesters[a]});b.each(d.xhrs,function(a){delete d.xhrs[a]})},_createXhr:function(a,d){return c._registerXhr(a,d,b.createXhrInstance())},_getAjaxRequester:function(a,b){var d=null==b?-1:b;return c._getFileState(a).temp.ajaxRequesters[d]},
_getChunkData:function(a,d){var e=g.partSize,f=m(a),h=c.getFile(a),k=e*d,e=k+e>=f?f:k+e,f=c._getTotalChunks(a),p=this._getFileState(a).temp.cachedChunks,h=p[d]||b.sliceBlob(h,k,e);p[d]=h;return{part:d,start:k,end:e,count:f,blob:h,size:e-k}},_getChunkDataForCallback:function(a){return{partIndex:a.part,startByte:a.start+1,endByte:a.end,totalParts:a.count}},_getLocalStorageId:function(a){var c=n(a),d=m(a),f=g.partSize;a=p(a);return b.format("qq{}resume{}-{}-{}-{}-{}",e,"5.0",c,d,f,a)},_getMimeType:function(a){return c.getFile(a).type},
_getPersistableData:function(a){return c._getFileState(a).chunking},_getTotalChunks:function(a){if(g)return a=m(a),Math.ceil(a/g.partSize)},_getXhr:function(a,b){var d=null==b?-1:b;return c._getFileState(a).temp.xhrs[d]},_getXhrs:function(a){return c._getFileState(a).temp.xhrs},_iterateResumeRecords:function(a){l&&b.each(localStorage,function(c,d){if(0===c.indexOf(b.format("qq{}resume",e))){var f=JSON.parse(d);a(c,f)}})},_initTempState:function(a){c._getFileState(a).temp={ajaxRequesters:{},chunkProgress:{},
xhrs:{},cachedChunks:{}}},_markNotResumable:function(a){c._getFileState(a).notResumable=!0},_maybeDeletePersistedChunkData:function(a){return l&&c.isResumable(a)&&(a=c._getLocalStorageId(a))&&localStorage.getItem(a)?(localStorage.removeItem(a),!0):!1},_maybePrepareForResume:function(a){var d=c._getFileState(a),e;l&&void 0===d.key&&(e=c._getLocalStorageId(a),e=localStorage.getItem(e))&&(e=JSON.parse(e),t(e.uuid)?c._markNotResumable(a):(v(b.format("Identified file with ID {} and name of {} as resumable.",
a,n(a))),w(a,e.uuid),d.key=e.key,d.chunking=e.chunking,d.loaded=e.loaded,d.attemptingResume=!0,c.moveInProgressToRemaining(a)))},_maybePersistChunkedState:function(a){var d=c._getFileState(a),e;if(l&&c.isResumable(a)){e=c._getLocalStorageId(a);d={name:n(a),size:m(a),uuid:q(a),key:d.key,chunking:d.chunking,loaded:d.loaded,lastUpdated:Date.now()};try{localStorage.setItem(e,JSON.stringify(d))}catch(f){v(b.format("Unable to save resume data for '{}' due to error: '{}'.",a,f.toString()),"warn")}}},_registerProgressHandler:function(a,
d,e){var f=c._getXhr(a,d),g=n(a),h={simple:function(b,c){var d=m(a);b===c?u(a,g,d,d):u(a,g,b>=d?d-1:b,d)},chunked:function(f,h){var k=c._getFileState(a).temp.chunkProgress,p=c._getFileState(a).loaded,q=m(a),l=p;k[d]=f-(h-e);b.each(k,function(a,b){l+=b});u(a,g,l,q)}};f.upload.onprogress=function(a){if(a.lengthComputable)h[null==e?"simple":"chunked"](a.loaded,a.total)}},_registerXhr:function(a,b,d,e){b=null==b?-1:b;a=c._getFileState(a).temp;a.xhrs=a.xhrs||{};a.ajaxRequesters=a.ajaxRequesters||{};a.xhrs[b]=
d;e&&(a.ajaxRequesters[b]=e);return d},_removeExpiredChunkingRecords:function(){var a=h.recordsExpireIn;c._iterateResumeRecords(function(b,c){var d=new Date(c.lastUpdated);d.setDate(d.getDate()+a);d.getTime()<=Date.now()&&(v("Removing expired resume record with key "+b),localStorage.removeItem(b))})},_shouldChunkThisFile:function(a){var b=c._getFileState(a);b.chunking||c.reevaluateChunking(a);return b.chunking.enabled}})};b.DeleteFileAjaxRequester=function(a){var d,c={method:"DELETE",uuidParamName:"qquuid",
endpointStore:{},maxConnections:3,customHeaders:function(a){return{}},paramsStore:{},cors:{expected:!1,sendCredentials:!1},log:function(a,b){},onDelete:function(a){},onDeleteComplete:function(a,b,c){}};b.extend(c,a);d=b.extend(this,new b.AjaxRequester({acceptHeader:"application/json",validMethods:["POST","DELETE"],method:c.method,endpointStore:c.endpointStore,paramsStore:c.paramsStore,mandatedParams:"POST"===c.method.toUpperCase()?{_method:"DELETE"}:{},maxConnections:c.maxConnections,customHeaders:function(a){return c.customHeaders.get(a)},
log:c.log,onSend:c.onDelete,onComplete:c.onDeleteComplete,cors:c.cors}));b.extend(this,{sendDelete:function(a,b,g){g=g||{};c.log("Submitting delete file request for "+a);"DELETE"===c.method?d.initTransport(a).withPath(b).withParams(g).send():(g[c.uuidParamName]=b,d.initTransport(a).withParams(g).send())}})};(function(){function a(a,c,e,f){var n=document.createElement("canvas"),m=e.mime||"image/jpeg",q=new b.Promise;d(a,c,n,e,f).then(function(){q.success(n.toDataURL(m,e.quality||.8))});return q}function d(a,
d,f,l,n){var m=a.naturalWidth,q=a.naturalHeight,p=l.width,t=l.height,w=f.getContext("2d"),u=new b.Promise;w.save();if(l.resize)return c({blob:d,canvas:f,image:a,imageHeight:q,imageWidth:m,orientation:l.orientation,resize:l.resize,targetHeight:t,targetWidth:p});if(!b.supportedFeatures.unlimitedScaledImageSize){d=p;var v=t;if(!b.ios())throw new b.Error("Downsampled dimensions can only be reliably calculated for iOS!");d=5241E3<v*d?{newHeight:Math.round(Math.sqrt(v/d*5241E3)),newWidth:Math.round(Math.sqrt(d/
v*5241E3))}:void 0;d&&(b.log(b.format("Had to reduce dimensions due to device limitations from {}w / {}h to {}w / {}h",p,t,d.newWidth,d.newHeight),"warn"),p=d.newWidth,t=d.newHeight)}e(f,p,t,l.orientation);if(b.ios()){l=a.naturalWidth;d=a.naturalHeight;v=document.createElement("canvas");1048576<l*d?(v.width=v.height=1,d=v.getContext("2d"),d.drawImage(a,-l+1,0),l=0===d.getImageData(0,0,1,1).data[3]):l=!1;l&&(m/=2,q/=2);l=document.createElement("canvas");if(n){n=q;var x=document.createElement("canvas");
d=0;var r=v=n,A;x.width=1;x.height=n;x=x.getContext("2d");x.drawImage(a,0,0);for(x=x.getImageData(0,0,1,n).data;r>d;)A=x[4*(r-1)+3],0===A?v=r:d=r,r=v+d>>1;n=r/n;n=0===n?1:n}else n=1;p=Math.ceil(1024*p/m);t=Math.ceil(1024*t/q/n);d=n=0;l.width=l.height=1024;for(v=l.getContext("2d");n<q;){for(x=r=0;r<m;)v.clearRect(0,0,1024,1024),v.drawImage(a,-r,-n),w.drawImage(l,0,0,1024,1024,x,d,p,t),r+=1024,x+=p;n+=1024;d+=t}w.restore()}else w.drawImage(a,0,0,p,t);f.qqImageRendered&&f.qqImageRendered();u.success();
return u}function c(a){var c=a.blob,d=a.image,f=a.imageHeight,n=a.imageWidth,m=a.orientation,q=new b.Promise,p=a.resize,t=document.createElement("canvas"),w=t.getContext("2d"),u=a.canvas,v=a.targetHeight;a=a.targetWidth;e(t,n,f,m);u.height=v;u.width=a;w.drawImage(d,0,0);p({blob:c,height:v,image:d,sourceCanvas:t,targetCanvas:u,width:a}).then(function(){u.qqImageRendered&&u.qqImageRendered();q.success()},q.failure);return q}function e(a,b,c,d){switch(d){case 5:case 6:case 7:case 8:a.width=c;a.height=
b;break;default:a.width=b,a.height=c}a=a.getContext("2d");switch(d){case 2:a.translate(b,0);a.scale(-1,1);break;case 3:a.translate(b,c);a.rotate(Math.PI);break;case 4:a.translate(0,c);a.scale(1,-1);break;case 5:a.rotate(.5*Math.PI);a.scale(1,-1);break;case 6:a.rotate(.5*Math.PI);a.translate(0,-c);break;case 7:a.rotate(.5*Math.PI);a.translate(b,-c);a.scale(-1,1);break;case 8:a.rotate(-.5*Math.PI),a.translate(-b,0)}}function f(a,b){var c=this;window.Blob&&a instanceof Blob&&function(){var b=new Image,
d=window.URL&&window.URL.createObjectURL?window.URL:window.webkitURL&&window.webkitURL.createObjectURL?window.webkitURL:null;if(!d)throw Error("No createObjectURL function found to create blob url");b.src=d.createObjectURL(a);c.blob=a;a=b}();a.naturalWidth||a.naturalHeight||(a.onload=function(){var a=c.imageLoadListeners;a&&(c.imageLoadListeners=null,setTimeout(function(){for(var b=0,c=a.length;b<c;b++)a[b]()},0))},a.onerror=b,this.imageLoadListeners=[]);this.srcImage=a}f.prototype.render=function(c,
e){e=e||{};var f=this,l=this.srcImage.naturalWidth,n=this.srcImage.naturalHeight,m=e.width,q=e.height,p=e.maxWidth,t=e.maxHeight,w=!this.blob||"image/jpeg"===this.blob.type,u=c.tagName.toLowerCase(),v;if(this.imageLoadListeners)this.imageLoadListeners.push(function(){f.render(c,e)});else if(m&&!q?q=n*m/l<<0:q&&!m?m=l*q/n<<0:(m=l,q=n),p&&m>p&&(m=p,q=n*m/l<<0),t&&q>t&&(q=t,m=l*q/n<<0),v={width:m,height:q},b.each(e,function(a,b){v[a]=b}),"img"===u?function(){var b=c.src;a(f.srcImage,f.blob,v,w).then(function(a){c.src=
a;b===c.src&&c.onload()})}():"canvas"===u&&d(this.srcImage,this.blob,c,v,w),"function"===typeof this.onrender)this.onrender(c)};b.MegaPixImage=f})();b.ImageGenerator=function(a){function d(a){return"img"===a.tagName.toLowerCase()}function c(a){return"canvas"===a.tagName.toLowerCase()}function e(a){a=a.split("/");a=a[a.length-1].split("?")[0];a=(a=b.getExtension(a))&&a.toLowerCase();switch(a){case "jpeg":case "jpg":return"image/jpeg";case "png":return"image/png";case "bmp":return"image/bmp";case "gif":return"image/gif";
case "tiff":case "tif":return"image/tiff"}}function f(a){var c=document.createElement("a"),d;c.href=a;a=c.protocol;d=c.port;c=c.hostname;return a.toLowerCase()!==window.location.protocol.toLowerCase()||c.toLowerCase()!==window.location.hostname.toLowerCase()||d!==window.location.port&&!b.ie()?!0:!1}function g(b,c){b.onload=function(){b.onload=null;b.onerror=null;c.success(b)};b.onerror=function(){b.onload=null;b.onerror=null;a("Problem drawing thumbnail!","error");c.failure(b,"Problem drawing thumbnail!")}}
function h(a,b){a.qqImageRendered=function(){b.success(a)}}function k(e,f){var k=d(e)||c(e);d(e)?g(e,f):c(e)?h(e,f):(f.failure(e),a(b.format("Element container of type {} is not supported!",e.tagName),"error"));return k}function l(c,d,e){var f=new b.Promise,g=new b.Identify(c,a),h=e.maxSize,l=null==e.orient?!0:e.orient,m=function(){d.onerror=null;d.onload=null;a("Could not render preview, file may be too large!","error");f.failure(d,"Browser cannot render image!")};g.isPreviewable().then(function(g){var n=
{parse:function(){return(new b.Promise).success()}},n=l?new b.Exif(c,a):n,u=new b.MegaPixImage(c,m);k(d,f)&&n.parse().then(function(a){u.render(d,{maxWidth:h,maxHeight:h,orientation:a&&a.Orientation,mime:g,resize:e.customResizeFunction})},function(c){a(b.format("EXIF data could not be parsed ({}).  Assuming orientation = 1.",c));u.render(d,{maxWidth:h,maxHeight:h,mime:g,resize:e.customResizeFunction})})},function(){a("Not previewable");f.failure(d,"Not previewable")});return f}function n(a,c,d,g,
h){var l=new Image,m=new b.Promise;k(l,m);f(a)&&(l.crossOrigin="anonymous");l.src=a;m.then(function(){k(c,d);(new b.MegaPixImage(l)).render(c,{maxWidth:g,maxHeight:g,mime:e(a),resize:h})},d.failure)}function m(a,c,d,e){k(c,d);b(c).css({maxWidth:e+"px",maxHeight:e+"px"});c.src=a}b.extend(this,{generate:function(e,g,h){if(b.isString(e)){a("Attempting to update thumbnail based on server response.");var w=h||{};h=new b.Promise;var u=w.scale,w=u?w.maxSize:null;u&&d(g)?(u=document.createElement("canvas"),
u.getContext&&u.getContext("2d")?f(e)&&void 0===(new Image).crossOrigin?m(e,g,h,w):n(e,g,h,w):m(e,g,h,w)):c(g)?n(e,g,h,w):k(g,h)&&(g.src=e);return h}a("Attempting to draw client-side image preview.");return l(e,g,h||{})}});this._testing={};this._testing.isImg=d;this._testing.isCanvas=c;this._testing.isCrossOrigin=f;this._testing.determineMimeOfFileName=e};b.Exif=function(a,d){function c(a){for(var b=0,c=0;0<a.length;)b+=parseInt(a.substring(0,2),16)*Math.pow(2,c),a=a.substring(2,a.length),c+=8;return b}
function e(c,d){var f=c,g=d;void 0===f&&(f=2,g=new b.Promise);b.readBlobToHex(a,f,4).then(function(a){var b=/^ffe([0-9])/.exec(a);b?"1"!==b[1]?(a=parseInt(a.slice(4,8),16),e(f+a+2,g)):g.success(f):g.failure("No EXIF header to be found!")});return g}function f(){var c=new b.Promise;b.readBlobToHex(a,0,6).then(function(a){0!==a.indexOf("ffd8")?c.failure("Not a valid JPEG!"):e().then(function(a){c.success(a)},function(a){c.failure(a)})});return c}function g(c){var d=new b.Promise;b.readBlobToHex(a,c+
10,2).then(function(a){d.success("4949"===a)});return d}function h(d,e){var f=new b.Promise;b.readBlobToHex(a,d+18,2).then(function(a){if(e)return f.success(c(a));f.success(parseInt(a,16))});return f}function k(a,d){var e=b.extend([],l),f={};b.each(d,function(b,d){var g=d.slice(0,4),h=a?c(g):parseInt(g,16),g=e.indexOf(h),k;0<=g&&(k=n[h].name,h=n[h].bytes,h=d.slice(16,16+2*h),f[k]=a?c(h):parseInt(h,16),e.splice(g,1));if(0===e.length)return!1});return f}var l=[274],n={274:{name:"Orientation",bytes:2}};
b.extend(this,{parse:function(){var c=new b.Promise,e=function(a){d(b.format("EXIF header parse failed: '{}' ",a));c.failure(a)};f().then(function(f){d(b.format("Moving forward with EXIF header parsing for '{}'",void 0===a.name?"blob":a.name));g(f).then(function(g){d(b.format("EXIF Byte order is {} endian",g?"little":"big"));h(f,g).then(function(h){d(b.format("Found {} APP1 directory entries",h));b.readBlobToHex(a,f+20,12*h).then(function(a){for(var b=[],e=0;e+24<=a.length;)b.push(a.slice(e,e+24)),
e+=24;a=k(g,b);d("Successfully parsed some EXIF tags");c.success(a)},e)},e)},e)},e);return c}});this._testing={};this._testing.parseLittleEndian=c};b.Identify=function(a,d){function c(a,c){var d=!1,h=[].concat(a);b.each(h,function(a,b){if(0===c.indexOf(b))return d=!0,!1});return d}b.extend(this,{isPreviewable:function(){var e=this,f=new b.Promise,g=!1,h=void 0===a.name?"blob":a.name;d(b.format("Attempting to determine if {} can be rendered in this browser",h));d("First pass: check type attribute of blob object.");
this.isPreviewableSync()?(d("Second pass: check for magic bytes in file header."),b.readBlobToHex(a,0,4).then(function(a){b.each(e.PREVIEWABLE_MIME_TYPES,function(d,e){if(c(e,a)){if("image/tiff"!==d||b.supportedFeatures.tiffPreviews)g=!0,f.success(d);return!1}});d(b.format("'{}' is {} able to be rendered in this browser",h,g?"":"NOT"));g||f.failure()},function(){d("Error reading file w/ name '"+h+"'.  Not able to be rendered in this browser.");f.failure()})):f.failure();return f},isPreviewableSync:function(){var c=
a.type,f=0<=b.indexOf(Object.keys(this.PREVIEWABLE_MIME_TYPES),c),g=!1,h=void 0===a.name?"blob":a.name;f&&(g="image/tiff"===c?b.supportedFeatures.tiffPreviews:!0);!g&&d(h+" is not previewable in this browser per the blob's type attr");return g}})};b.Identify.prototype.PREVIEWABLE_MIME_TYPES={"image/jpeg":"ffd8ff","image/gif":"474946","image/png":"89504e","image/bmp":"424d","image/tiff":["49492a00","4d4d002a"]};b.ImageValidation=function(a,d){function c(a){var c=!1;b.each(a,function(a,b){if(0<b)return c=
!0,!1});return c}function e(){var c=new b.Promise;(new b.Identify(a,d)).isPreviewable().then(function(){var b=new Image,e=window.URL&&window.URL.createObjectURL?window.URL:window.webkitURL&&window.webkitURL.createObjectURL?window.webkitURL:null;e?(b.onerror=function(){d("Cannot determine dimensions for image.  May be too large.","error");c.failure()},b.onload=function(){c.success({width:this.width,height:this.height})},b.src=e.createObjectURL(a)):(d("No createObjectURL function available to generate image URL!",
"error"),c.failure())},c.failure);return c}function f(a,c){var d;b.each(a,function(a,b){if(0<b){var e=/(max|min)(Width|Height)/.exec(a),f=e[2].charAt(0).toLowerCase()+e[2].slice(1),f=c[f];switch(e[1]){case "min":if(f<b)return d=a,!1;break;case "max":if(f>b)return d=a,!1}}});return d}this.validate=function(a){var h=new b.Promise;d("Attempting to validate image.");c(a)?e().then(function(b){(b=f(a,b))?h.failure(b):h.success()},h.success):h.success();return h}};b.Session=function(a){function d(a,d,g,
h){var k=!1;d&&(b.isArray(a)?d=!0:(c.log("Session response is not an array.","error"),d=void 0));d&&b.each(a,function(a,d){if(null==d.uuid)k=!0,c.log(b.format("Session response item {} did not include a valid UUID - ignoring.",a),"error");else if(null==d.name)k=!0,c.log(b.format("Session response item {} did not include a valid name - ignoring.",a),"error");else try{return c.addFileRecord(d),!0}catch(e){k=!0,c.log(e.message,"error")}return!1});h[d&&!k?"success":"failure"](a,g)}var c={endpoint:null,
params:{},customHeaders:{},cors:{},addFileRecord:function(a){},log:function(a,b){}};b.extend(c,a,!0);this.refresh=function(){var a=new b.Promise,f=b.extend({},c);(new b.SessionAjaxRequester(b.extend(f,{onComplete:function(b,c,f){d(b,c,f,a)}}))).queryServer();return a}};b.SessionAjaxRequester=function(a){var d,c={endpoint:null,customHeaders:{},params:{},cors:{expected:!1,sendCredentials:!1},onComplete:function(a,b,c){},log:function(a,b){}};b.extend(c,a);d=b.extend(this,new b.AjaxRequester({acceptHeader:"application/json",
validMethods:["GET"],method:"GET",endpointStore:{get:function(){return c.endpoint}},customHeaders:c.customHeaders,log:c.log,onComplete:function(a,d,g){a=null;if(null!=d.responseText)try{a=b.parseJson(d.responseText)}catch(h){c.log("Problem parsing session response: "+h.message,"error"),g=!0}c.onComplete(a,!g,d)},cors:c.cors}));b.extend(this,{queryServer:function(){var a=b.extend({},c.params);c.log("Session query request.");d.initTransport("sessionRefresh").withParams(a).withCacheBuster().send()}})};
b.Scaler=function(a,d){var c=a.customResizer,e=a.sendOriginal,f=a.orient,g=a.defaultType,h=a.defaultQuality/100,k=a.failureText,l=a.includeExif,n=this._getSortedSizes(a.sizes);b.extend(this,{enabled:b.supportedFeatures.scaling&&0<n.length,getFileRecords:function(a,q,p){var t=this,w=[],u=p.blob?p.blob:p;(new b.Identify(u,d)).isPreviewableSync()?(b.each(n,function(a,e){var n=t._determineOutputType({defaultType:g,requestedType:e.type,refType:u.type});w.push({uuid:b.getUniqueId(),name:t._getName(q,{name:e.name,
type:n,refType:u.type}),blob:new b.BlobProxy(u,b.bind(t._generateScaledImage,t,{customResizeFunction:c,maxSize:e.maxSize,orient:f,type:n,quality:h,failedText:k,includeExif:l,log:d}))})}),w.push({uuid:a,name:q,size:u.size,blob:e?u:null})):w.push({uuid:a,name:q,size:u.size,blob:u});return w},handleNewFile:function(a,c,d,e,f,g,h,k){var l=[],n=null,E=k.addFileToHandler,y=k.uploadData,B=k.paramsStore,F=b.getUniqueId();b.each(this.getFileRecords(d,c,a),function(a,c){var d=c.size;c.blob instanceof b.BlobProxy&&
(d=-1);d=y.addFile({uuid:c.uuid,name:c.name,size:d,batchId:g,proxyGroupId:F});c.blob instanceof b.BlobProxy?l.push(d):n=d;c.blob?(E(d,c.blob),f.push({id:d,file:c.blob})):y.setStatus(d,b.status.REJECTED)});null!==n&&(b.each(l,function(a,b){var c={qqparentuuid:y.retrieve({id:n}).uuid,qqparentsize:y.retrieve({id:n}).size};c[h]=y.retrieve({id:b}).uuid;y.setParentId(b,n);B.addReadOnly(b,c)}),l.length&&function(){var a={};a[h]=y.retrieve({id:n}).uuid;B.addReadOnly(n,a)}())}})};b.extend(b.Scaler.prototype,
{scaleImage:function(a,d,c){if(!b.supportedFeatures.scaling)throw new b.Error("Scaling is not supported in this browser!");var e=new b.Promise,f=c.log,g=c.getFile(a),h=(c=c.uploadData.retrieve({id:a}))&&c.name,k=c&&c.uuid,l=new b.Scaler({customResizer:d.customResizer,sendOriginal:!1,orient:d.orient,defaultType:d.type||null,defaultQuality:d.quality,failedToScaleText:"Unable to scale",sizes:[{name:"",maxSize:d.maxSize}]},f);b.Scaler&&b.supportedFeatures.imagePreviews&&g?b.bind(function(){var c=l.getFileRecords(k,
h,g)[0];c&&c.blob instanceof b.BlobProxy?c.blob.create().then(e.success,e.failure):(f(a+" is not a scalable image!","error"),e.failure())},this)():(e.failure(),f("Could not generate requested scaled image for "+a+".  Scaling is either not possible in this browser, or the file could not be located.","error"));return e},_determineOutputType:function(a){var d=a.requestedType,c=a.defaultType;a=a.refType;return c||d?d?0<=b.indexOf(Object.keys(b.Identify.prototype.PREVIEWABLE_MIME_TYPES),d)?"image/tiff"===
d?b.supportedFeatures.tiffPreviews?d:c:d:c:c:"image/jpeg"!==a?"image/png":a},_getName:function(a,d){var c=a.lastIndexOf("."),e=d.type||"image/png",f=d.refType,g="",h=b.getExtension(a),k="";d.name&&d.name.trim().length&&(k=" ("+d.name+")");0<=c?(g=a.substr(0,c),f!==e&&(h=e.split("/")[1]),g+=k+"."+h):g=a+k;return g},_getSortedSizes:function(a){a=b.extend([],a);return a.sort(function(a,b){return a.maxSize>b.maxSize?1:a.maxSize<b.maxSize?-1:0})},_generateScaledImage:function(a,d){var c=this,e=a.customResizeFunction,
f=a.log,g=a.maxSize,h=a.orient,k=a.type,l=a.quality,n=a.failedText,m=a.includeExif&&"image/jpeg"===d.type&&"image/jpeg"===k,q=new b.Promise,p=new b.ImageGenerator(f),t=document.createElement("canvas");f("Attempting to generate scaled version for "+d.name);p.generate(d,t,{maxSize:g,orient:h,customResizeFunction:e}).then(function(){var a=t.toDataURL(k,l),e=function(){f("Success generating scaled version for "+d.name);var c=b.dataUriToBlob(a);q.success(c)};m?c._insertExifHeader(d,a,f).then(function(b){a=
b;e()},function(){f("Problem inserting EXIF header into scaled image.  Using scaled image w/out EXIF data.","error");e()}):e()},function(){f("Failed attempt to generate scaled version for "+d.name,"error");q.failure(n)});return q},_insertExifHeader:function(a,d,c){var e=new FileReader,f=new b.Promise,g="";e.onload=function(){g=e.result;f.success(b.ExifRestorer.restore(g,d))};e.onerror=function(){c("Problem reading "+a.name+" during attempt to transfer EXIF data to scaled version.","error");f.failure()};
e.readAsDataURL(a);return f},_dataUriToBlob:function(a){var d,c,e;d=0<=a.split(",")[0].indexOf("base64")?atob(a.split(",")[1]):decodeURI(a.split(",")[1]);a=a.split(",")[0].split(":")[1].split(";")[0];c=new ArrayBuffer(d.length);e=new Uint8Array(c);b.each(d,function(a,b){e[a]=b.charCodeAt(0)});return this._createBlob(c,a)},_createBlob:function(a,b){var c=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;return(c=c&&new c)?(c.append(a),c.getBlob(b)):new Blob([a],
{type:b})}});b.ExifRestorer=function(){return{KEY_STR:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode64:function(a){var b="",c,e,f="",g,h,k="",l=0;do c=a[l++],e=a[l++],f=a[l++],g=c>>2,c=(c&3)<<4|e>>4,h=(e&15)<<2|f>>6,k=f&63,isNaN(e)?h=k=64:isNaN(f)&&(k=64),b=b+this.KEY_STR.charAt(g)+this.KEY_STR.charAt(c)+this.KEY_STR.charAt(h)+this.KEY_STR.charAt(k);while(l<a.length);return b},restore:function(a,b){if(!a.match("data:image/jpeg;base64,"))return b;var c=this.decode64(a.replace("data:image/jpeg;base64,",
"")),c=this.slice2Segments(c),c=this.exifManipulation(b,c);return"data:image/jpeg;base64,"+this.encode64(c)},exifManipulation:function(a,b){var c=this.getExifArray(b),c=this.insertExif(a,c);return new Uint8Array(c)},getExifArray:function(a){for(var b,c=0;c<a.length;c++)if(b=a[c],255==b[0]&225==b[1])return b;return[]},insertExif:function(a,b){var c=a.replace("data:image/jpeg;base64,",""),e=this.decode64(c),f=e.indexOf(255,3),c=e.slice(0,f),e=e.slice(f),c=c.concat(b);return c=c.concat(e)},slice2Segments:function(a){for(var b=
0,c=[];!(255==a[b]&218==a[b+1]);){if(255==a[b]&216==a[b+1])b+=2;else{var e=b+(256*a[b+2]+a[b+3])+2,b=a.slice(b,e);c.push(b);b=e}if(b>a.length)break}return c},decode64:function(a){var b,c,e="",f,g="",h=0,k=[];if(/[^A-Za-z0-9\+\/\=]/g.exec(a))throw Error("There were invalid base64 characters in the input text.  Valid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='");a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");do b=this.KEY_STR.indexOf(a.charAt(h++)),c=this.KEY_STR.indexOf(a.charAt(h++)),f=this.KEY_STR.indexOf(a.charAt(h++)),
g=this.KEY_STR.indexOf(a.charAt(h++)),b=b<<2|c>>4,c=(c&15)<<4|f>>2,e=(f&3)<<6|g,k.push(b),64!=f&&k.push(c),64!=g&&k.push(e);while(h<a.length);return k}}}();b.TotalProgress=function(a,d){var c={},e=0,f=0,g=-1,h=-1,k=function(b,c){b===g&&c===h||a(b,c);g=b;h=c},l=function(a,c){var d=!0;b.each(a,function(a,e){if(0<=b.indexOf(c,e))return d=!1});return d},n=function(a){var b=d(a);0<b&&(m(a,0,b),c[a]={loaded:0,total:b})},m=function(a,b,d){var g=c[a]?c[a].loaded:0;a=c[a]?c[a].total:0;-1===b&&-1===d?(e-=g,
f-=a):(b&&(e+=b-g),d&&(f+=d-a));k(e,f)};b.extend(this,{onAllComplete:function(a,b,c){if(0===b.length||l(b,c))k(f,f),this.reset()},onStatusChange:function(a,d,e){e===b.status.CANCELED||e===b.status.REJECTED?(m(a,-1,-1),delete c[a]):e===b.status.SUBMITTING&&n(a)},onIndividualProgress:function(a,b,d){m(a,b,d);c[a]={loaded:b,total:d}},onNewSize:function(a){n(a)},reset:function(){c={};f=e=0}})};b.PasteSupport=function(a){var d,c;d={targetElement:null,callbacks:{log:function(a,b){},pasteReceived:function(a){}}};
b.extend(d,a);(function(){c=b(d.targetElement).attach("paste",function(a){(a=a.clipboardData)&&b.each(a.items,function(a,b){if(b.type&&0===b.type.indexOf("image/")){var c=b.getAsFile();d.callbacks.pasteReceived(c)}})})})();b.extend(this,{reset:function(){c&&c()}})};b.FormSupport=function(a,d,c){function e(a,b){if(a.checkValidity&&!a.checkValidity())c("Form did not pass validation checks - will not upload.","error"),b();else return!0}function f(a){var c=a.submit;b(a).attach("submit",function(b){b=
b||window.event;b.preventDefault?b.preventDefault():b.returnValue=!1;e(a,c)&&d()});a.submit=function(){e(a,c)&&d()}}var g=this,h=a.interceptSubmit,k=a.element;b.extend(this,{newEndpoint:null,newAutoUpload:a.autoUpload,attachedToForm:!1,getFormInputsAsObject:function(){return null==k?null:g._form2Obj(k)}});k=function(a){if(a&&(b.isString(a)&&(a=document.getElementById(a)),a)){c("Attaching to form element.");var d=a;d.getAttribute("action")&&(g.newEndpoint=d.getAttribute("action"));h&&f(a)}return a}(k);
this.attachedToForm=!!k};b.extend(b.FormSupport.prototype,{_form2Obj:function(a){var d={},c=function(a){return 0<=b.indexOf(["checkbox","radio"],a.type.toLowerCase())&&!a.checked?!0:a.disabled&&"hidden"!==a.type.toLowerCase()},e=function(a){var c=null;b.each(b(a).children(),function(a,b){if("option"===b.tagName.toLowerCase()&&b.selected)return c=b.value,!1});return c};b.each(a.elements,function(a,g){var h;if(h=b.isInput(g,!0)||"textarea"===g.tagName.toLowerCase())h=0>b.indexOf(["button","image","reset",
"submit"],g.type.toLowerCase());h&&!c(g)?d[g.name]=g.value:"select"!==g.tagName.toLowerCase()||c(g)||(h=e(g),null!==h&&(d[g.name]=h))});return d}});b.traditional=b.traditional||{};b.traditional.FormUploadHandler=function(a,d){function c(b,c){var d=a.paramsStore.get(b),h="get"===a.method.toLowerCase()?"GET":"POST",q=a.endpointStore.get(b),p=f(b);d[a.uuidName]=g(b);d[a.filenameParam]=p;return e._initFormForUpload({method:h,endpoint:q,params:d,paramsInBody:a.paramsInBody,targetName:c.name})}var e=this,
f=d.getName,g=d.getUuid,h=d.log;this.uploadFile=function(d){var f=e.getInput(d),g=e._createIframe(d),m=new b.Promise,q;q=c(d,g);q.appendChild(f);e._attachLoadEvent(g,function(c){h("iframe loaded");if(!c){var f,l,u;try{l=g.contentDocument||g.contentWindow.document,u=l.body.innerHTML,h("converting iframe's innerHTML to JSON"),h("innerHTML = "+u),u&&u.match(/^<pre/i)&&(u=l.body.firstChild.firstChild.nodeValue),f=e._parseJsonResponse(u)}catch(v){h("Error when attempting to parse form upload response ("+
v.message+")","error"),f={success:!1}}c=f}e._detachLoadEvent(d);a.cors.expected||b(g).remove();c.success?m.success(c):m.failure(c)});h("Sending upload request for "+d);q.submit();b(q).remove();return m};b.extend(this,new b.FormUploadHandler({options:{isCors:a.cors.expected,inputName:a.inputName},proxy:{onCancel:a.onCancel,getName:f,getUuid:g,log:h}}))};b.traditional=b.traditional||{};b.traditional.XhrUploadHandler=function(a,d){var c=this,e=d.getName,f=d.getSize,g=d.getUuid,h=d.log,k=a.forceMultipart||
a.paramsInBody,l=new b.traditional.AllChunksDoneAjaxRequester({cors:a.cors,endpoint:a.chunking.success.endpoint,log:h}),n=function(a,c){var d=new b.Promise;c.onreadystatechange=function(){var e;if(4===c.readyState){var f;h("xhr - server response received for "+a);h("responseText = "+c.responseText);f=q(!0,c);(e=!(0>b.indexOf([200,201,202,203,204],c.status)||!f.success||f.reset))?d.success(f,c):d.failure(f,c)}};return d},m=function(b){var d=a.paramsStore.get(b),h=e(b),k=f(b);d[a.uuidName]=g(b);d[a.filenameParam]=
h;d[a.totalFileSizeName]=k;d[a.chunking.paramNames.totalParts]=c._getTotalChunks(b);return d},q=function(a,c){var d={};try{h(b.format("Received response status {} with body: {}",c.status,c.responseText)),d=b.parseJson(c.responseText)}catch(e){a&&h("Error when attempting to parse xhr response text ("+e.message+")","error")}return d},p=function(d){var e=new b.Promise;l.complete(d,c._createXhr(d),m(d),a.customHeaders.get(d)).then(function(a){e.success(q(!1,a),a)},function(a){e.failure(q(!1,a),a)});return e},
t=function(c,d,h,l){var n=new FormData,m=a.method,p=a.endpointStore.get(l),q=e(l),t=f(l);c[a.uuidName]=g(l);c[a.filenameParam]=q;k&&(c[a.totalFileSizeName]=t);a.paramsInBody||(k||(c[a.inputName]=q),p=b.obj2url(c,p));d.open(m,p,!0);a.cors.expected&&a.cors.sendCredentials&&(d.withCredentials=!0);return k?(a.paramsInBody&&b.obj2FormData(c,n),n.append(a.inputName,h),n):h},w=function(d,e){var f=a.customHeaders.get(d),g=c.getFile(d);e.setRequestHeader("Accept","application/json");e.setRequestHeader("X-Requested-With",
"XMLHttpRequest");e.setRequestHeader("Cache-Control","no-cache");k||(e.setRequestHeader("Content-Type","application/octet-stream"),e.setRequestHeader("X-Mime-Type",g.type));b.each(f,function(a,b){e.setRequestHeader(a,b)})};b.extend(this,{uploadChunk:function(b,d,g){var h=c._getChunkData(b,d),l=c._createXhr(b,d);f(b);var m;m=n(b,l);c._registerProgressHandler(b,d,h.size);d=a.paramsStore.get(b);var p=f(b),q=e(b);d[a.chunking.paramNames.partIndex]=h.part;d[a.chunking.paramNames.partByteOffset]=h.start;
d[a.chunking.paramNames.chunkSize]=h.size;d[a.chunking.paramNames.totalParts]=h.count;d[a.totalFileSizeName]=p;k&&(d[a.filenameParam]=q);g&&(d[a.resume.paramNames.resuming]=!0);g=t(d,l,h.blob,b);w(b,l);l.send(g);return m},uploadFile:function(b){var d=c.getFile(b),e,f,g;f=c._createXhr(b);c._registerProgressHandler(b);e=n(b,f);g=a.paramsStore.get(b);d=t(g,f,d,b);w(b,f);f.send(d);return e}});b.extend(this,new b.XhrUploadHandler({options:b.extend({namespace:"traditional"},a),proxy:b.extend({getEndpoint:a.endpointStore.get},
d)}));b.override(this,function(c){return{finalizeChunks:function(d){return a.chunking.success.endpoint?p(d):c.finalizeChunks(d,b.bind(q,this,!0))}}})};b.traditional.AllChunksDoneAjaxRequester=function(a){var d,c={cors:{allowXdr:!1,expected:!1,sendCredentials:!1},endpoint:null,log:function(a,b){}},e={};b.extend(c,a);d=b.extend(this,new b.AjaxRequester({acceptHeader:"application/json",validMethods:["POST"],method:"POST",endpointStore:{get:function(a){return c.endpoint}},allowXRequestedWithAndCacheControl:!1,
cors:c.cors,log:c.log,onComplete:function(a,b,c){var d=e[a];delete e[a];c?d.failure(b):d.success(b)}}));b.extend(this,{complete:function(a,g,h,k){var l=new b.Promise;c.log("Submitting All Chunks Done request for "+a);e[a]=l;d.initTransport(a).withParams(h).withHeaders(k).send(g);return l}})}})(window);
