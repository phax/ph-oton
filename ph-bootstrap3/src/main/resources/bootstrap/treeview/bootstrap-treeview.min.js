(function(c,h,k,g){var l={injectStyle:!0,levels:2,expandIcon:"glyphicon glyphicon-plus",collapseIcon:"glyphicon glyphicon-minus",emptyIcon:"glyphicon",nodeIcon:"glyphicon glyphicon-stop",color:g,backColor:g,borderColor:g,onhoverColor:"#F5F5F5",selectedColor:"#FFFFFF",selectedBackColor:"#428bca",searchResultColor:"#D9534F",searchResultBackColor:g,enableLinks:!1,highlightSelected:!0,highlightSearchResults:!0,showBorder:!0,showTags:!1,multiSelect:!1,onNodeCollapsed:g,onNodeExpanded:g,onNodeSelected:g,
onNodeUnselected:g,onSearchComplete:g,onSearchCleared:g},e=function(a,b){this.$element=c(a);this.elementId=a.id;this.styleId=this.elementId+"-style";this.init(b);return{options:this.options,init:c.proxy(this.init,this),remove:c.proxy(this.remove,this),getNode:c.proxy(this.getNode,this),getParent:c.proxy(this.getParent,this),getSiblings:c.proxy(this.getSiblings,this),selectNode:c.proxy(this.selectNode,this),unselectNode:c.proxy(this.unselectNode,this),toggleNodeSelected:c.proxy(this.toggleNodeSelected,
this),collapseAll:c.proxy(this.collapseAll,this),collapseNode:c.proxy(this.collapseNode,this),expandAll:c.proxy(this.expandAll,this),expandNode:c.proxy(this.expandNode,this),toggleNodeExpanded:c.proxy(this.toggleNodeExpanded,this),search:c.proxy(this.search,this),clearSearch:c.proxy(this.clearSearch,this)}};e.prototype.init=function(a){this.tree=[];this.nodes=[];a.data&&("string"===typeof a.data&&(a.data=c.parseJSON(a.data)),this.tree=c.extend(!0,[],a.data),delete a.data);this.options=c.extend({},
l,a);this.destroy();this.subscribeEvents();this.setInitialStates({nodes:this.tree},0);this.render()};e.prototype.remove=function(){this.destroy();c.removeData(this,"treeview");c("#"+this.styleId).remove()};e.prototype.destroy=function(){this.initialized&&(this.$wrapper.remove(),this.$wrapper=null,this.unsubscribeEvents(),this.initialized=!1)};e.prototype.unsubscribeEvents=function(){this.$element.off("click");"function"===typeof this.options.onNodeCollapsed&&this.$element.off("nodeCollapsed");"function"===
typeof this.options.onNodeExpanded&&this.$element.off("nodeExpanded");"function"===typeof this.options.onNodeSelected&&this.$element.off("nodeSelected");"function"===typeof this.options.onNodeUnselected&&this.$element.off("nodeUnselected");"function"===typeof this.options.onSearchComplete&&this.$element.off("searchComplete");"function"===typeof this.options.onSearchCleared&&this.$element.off("searchCleared")};e.prototype.subscribeEvents=function(){this.unsubscribeEvents();this.$element.on("click",
c.proxy(this.clickHandler,this));if("function"===typeof this.options.onNodeCollapsed)this.$element.on("nodeCollapsed",this.options.onNodeCollapsed);if("function"===typeof this.options.onNodeExpanded)this.$element.on("nodeExpanded",this.options.onNodeExpanded);if("function"===typeof this.options.onNodeSelected)this.$element.on("nodeSelected",this.options.onNodeSelected);if("function"===typeof this.options.onNodeUnselected)this.$element.on("nodeUnselected",this.options.onNodeUnselected);if("function"===
typeof this.options.onSearchComplete)this.$element.on("searchComplete",this.options.onSearchComplete);if("function"===typeof this.options.onSearchCleared)this.$element.on("searchCleared",this.options.onSearchCleared)};e.prototype.setInitialStates=function(a,b){if(a.nodes){b+=1;var d=this;c.each(a.nodes,function(c,f){f.nodeId=d.nodes.length;f.parentId=a.nodeId;f.hasOwnProperty("selectable")||(f.selectable=!0);f.state=f.state||{};f.state.hasOwnProperty("expanded")||(f.state.expanded=b<d.options.levels?
!0:!1);f.state.hasOwnProperty("selected")||(f.state.selected=!1);d.nodes.push(f);f.nodes&&d.setInitialStates(f,b)})}};e.prototype.clickHandler=function(a){this.options.enableLinks||a.preventDefault();var b=c(a.target);a=b.attr("class")?b.attr("class").split(" "):[];b=this.findNode(b);-1!=a.indexOf("click-expand")||-1!=a.indexOf("click-collapse")?this.toggleExpandedState(b):b&&(b.selectable?this.toggleSelectedState(b):this.toggleExpandedState(b))};e.prototype.findNode=function(a){a=a.closest("li.list-group-item").attr("data-nodeid");
(a=this.nodes[a])||console.log("Error: node does not exist");return a};e.prototype.toggleExpandedState=function(a,b){a&&(this.setExpandedState(a,!a.state.expanded,b),this.render())};e.prototype.setExpandedState=function(a,b,d){b?(a.state.expanded=!0,d||this.$element.trigger("nodeExpanded",c.extend(!0,{},a))):(a.state.expanded=!1,d||this.$element.trigger("nodeCollapsed",c.extend(!0,{},a)))};e.prototype.toggleSelectedState=function(a,b){a&&(this.setSelectedState(a,!a.state.selected,b),this.render())};
e.prototype.setSelectedState=function(a,b,d){b?(this.options.multiSelect||c.each(this.findNodes("true","g","state.selected"),c.proxy(function(a,b){this.setSelectedState(b,!1,d)},this)),a.state.selected=!0,d||this.$element.trigger("nodeSelected",c.extend(!0,{},a))):(a.state.selected=!1,d||this.$element.trigger("nodeUnselected",c.extend(!0,{},a)))};e.prototype.render=function(){this.initialized||(this.$element.addClass("treeview"),this.$wrapper=c(this.template.list),this.injectStyle(),this.initialized=
!0);this.$element.empty().append(this.$wrapper.empty());this.buildTree(this.tree,0)};e.prototype.buildTree=function(a,b){if(a){b+=1;var d=this;c.each(a,function(a,f){for(var e=c(d.template.item).addClass("node-"+d.elementId).addClass(f.state.selected?"node-selected":"").addClass(f.searchResult?"search-result":"").attr("data-nodeid",f.nodeId).attr("style",d.buildStyleOverride(f)),g=0;g<b-1;g++)e.append(d.template.indent);f.nodes?f.state.expanded?e.append(c(d.template.expandCollapseIcon).addClass("click-collapse").addClass(d.options.collapseIcon)):
e.append(c(d.template.expandCollapseIcon).addClass("click-expand").addClass(d.options.expandIcon)):e.append(c(d.template.expandCollapseIcon).addClass(d.options.emptyIcon));e.append(c(d.template.icon).addClass(f.icon?f.icon:d.options.nodeIcon));d.options.enableLinks?e.append(c(d.template.link).attr("href",f.href).append(f.text)):e.append(f.text);d.options.showTags&&f.tags&&c.each(f.tags,function(a,b){e.append(c(d.template.badge).append(b))});d.$wrapper.append(e);if(f.nodes&&f.state.expanded)return d.buildTree(f.nodes,
b)})}};e.prototype.buildStyleOverride=function(a){var b=a.color,d=a.backColor;this.options.highlightSelected&&a.state.selected&&(this.options.selectedColor&&(b=this.options.selectedColor),this.options.selectedBackColor&&(d=this.options.selectedBackColor));this.options.highlightSearchResults&&a.searchResult&&(this.options.searchResultColor&&(b=this.options.searchResultColor),this.options.searchResultBackColor&&(d=this.options.searchResultBackColor));return"color:"+b+";background-color:"+d+";"};e.prototype.injectStyle=
function(){this.options.injectStyle&&!k.getElementById(this.styleId)&&c('<style type="text/css" id="'+this.styleId+'"> '+this.buildStyle()+" </style>").appendTo("head")};e.prototype.buildStyle=function(){var a=".node-"+this.elementId+"{";this.options.color&&(a+="color:"+this.options.color+";");this.options.backColor&&(a+="background-color:"+this.options.backColor+";");this.options.showBorder?this.options.borderColor&&(a+="border:1px solid "+this.options.borderColor+";"):a+="border:none;";a+="}";this.options.onhoverColor&&
(a+=".node-"+this.elementId+":hover{background-color:"+this.options.onhoverColor+";}");return this.css+a};e.prototype.template={list:'<ul class="list-group"></ul>',item:'<li class="list-group-item"></li>',indent:'<span class="indent"></span>',expandCollapseIcon:'<span class="expand-collapse"></span>',icon:'<span class="icon"></span>',link:'<a href="#" style="color:inherit;"></a>',badge:'<span class="badge"></span>'};e.prototype.css=".treeview .list-group-item{cursor:pointer}.treeview span.indent{margin-left:10px;margin-right:10px}.treeview span.expand-collapse{width:1rem;height:1rem}.treeview span.icon{margin-left:10px;margin-right:5px}";
e.prototype.getNode=function(a){return this.nodes[a]};e.prototype.getParent=function(a){a=this.identifyNode(a);return this.nodes[a.parentId]};e.prototype.getSiblings=function(a){var b=this.identifyNode(a);a=this.getParent(b);return(a?a.nodes:this.tree).filter(function(a){return a.nodeId!==b.nodeId})};e.prototype.selectNode=function(a,b){var d=this.isSilent(b);this.setSelectedState(this.identifyNode(a),!0,d);this.render()};e.prototype.unselectNode=function(a,b){var d=this.isSilent(b);this.setSelectedState(this.identifyNode(a),
!1,d);this.render()};e.prototype.toggleNodeSelected=function(a,b){this.toggleSelectedState(this.identifyNode(a),this.isSilent(b))};e.prototype.collapseAll=function(a){var b=this.isSilent(a);c.each(this.nodes,c.proxy(function(a,c){this.setExpandedState(c,!1,b)},this));this.render()};e.prototype.collapseNode=function(a,b){var d=this.isSilent(b);this.setExpandedState(this.identifyNode(a),!1,d);this.render()};e.prototype.expandAll=function(a){var b=this.isSilent(a);a&&a.levels?this.expandLevels(this.tree,
a.levels,b):c.each(this.nodes,c.proxy(function(a,c){this.setExpandedState(c,!0,b)},this));this.render()};e.prototype.expandNode=function(a,b){var d=this.isSilent(b),c=this.identifyNode(a);this.setExpandedState(c,!0,d);c.nodes&&b&&b.levels&&this.expandLevels(c.nodes,b.levels-1,d);this.render()};e.prototype.expandLevels=function(a,b,d){c.each(a,c.proxy(function(a,c){this.setExpandedState(c,0<b?!0:!1);c.nodes&&this.expandLevels(c.nodes,b-1,d)},this))};e.prototype.toggleNodeExpanded=function(a,b){this.toggleExpandedState(this.identifyNode(a),
this.isSilent(b))};e.prototype.identifyNode=function(a){return"number"===typeof a?this.nodes[a]:a};e.prototype.isSilent=function(a){return a&&a.hasOwnProperty("silent")?a.silent:!1};e.prototype.search=function(a,b){this.clearSearch();var d=[];a&&0<a.length&&(b.exactMatch&&(a="^"+a+"$"),d="g",b.ignoreCase&&(d+="i"),d=this.findNodes(a,d),c.each(d,function(a,b){b.searchResult=!0}),this.render());this.$element.trigger("searchComplete",c.extend(!0,{},d));return d};e.prototype.clearSearch=function(){var a=
c.each(this.findNodes("true","g","searchResult"),function(a,c){c.searchResult=!1});this.render();this.$element.trigger("searchCleared",c.extend(!0,{},a))};e.prototype.findNodes=function(a,b,d){b=b||"g";d=d||"text";var e=this;return c.grep(this.nodes,function(c){c=e.getNodeValue(c,d);if("string"===typeof c)return c.match(new RegExp(a,b))})};e.prototype.getNodeValue=function(a,b){var c=b.indexOf(".");if(0<c){var e=a[b.substring(0,c)],c=b.substring(c+1,b.length);return this.getNodeValue(e,c)}return a.hasOwnProperty(b)?
a[b].toString():g};c.fn.treeview=function(a,b){var d;this.each(function(){var g=c.data(this,"treeview");"string"===typeof a?g?c.isFunction(g[a])&&"_"!==a.charAt(0)?(b instanceof Array||(b=[b]),d=g[a].apply(g,b)):h.console&&h.console.error("No such method : "+a):h.console&&h.console.error("Not initialized, can not call method : "+a):"boolean"===typeof a?d=g:c.data(this,"treeview",new e(this,c.extend(!0,{},a)))});return d||this}})(jQuery,window,document);
